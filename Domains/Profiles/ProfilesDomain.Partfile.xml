<?xml version="1.0" encoding="utf-8"?>
<BuildContext xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="../../bsicommon/build/PartFile.xsd">

    <!-- A convenience to platform developers that want to build platform and use Gist as their testbed. -->
    <!-- <Part Name="ProfilesDomainWithGist" PrgOutputDir="DgnClientSdk" Sequential="true">
        <SubPart PartName="DgnClientSdk-Tested" PartFile="DgnClientFx" Repository="DgnClientFx" />
        <SubPart PartName="Gist" PartFile="Gist" Repository="Gist" />
        <SubProduct ProductName="ProfilesDomainTested" />
    </Part> -->

    <Product Name="ProfilesDomainSDK">
        <SubPart PartName="ProfilesDomainDLL" />
        <SubPart PartName="ProfilesDoc" />
        <Directories DirectoryListName="ProfilesSDKDirs" />
    </Product>

    <Product Name="ProfilesDomainTested">
        <SubProduct ProductName="ProfilesDomainSDK" />
        <SubPart PartName="RunProfilesTests" />
        <Directories DirectoryListName="ProfilesSDKDirs" />
        <Directories DirectoryListName="ProfilesTestsDirs" />
    </Product>

    <Part Name="ProfilesDomainTestedDev">
        <!-- DgnDbTestingScripts are needed in order to run tests from the shell with a filter (GTEST_FILTER) -->
        <RequiredRepository>DgnDbTestingScripts</RequiredRepository>
        <SubProduct ProductName="ProfilesDomainTested" />
    </Part>

    <Part Name="ProfilesDomainDLL" BentleyBuildMakeFile="Profiles/ProfilesDomainDLL.mke" ApiNumber="M02">
        <SubPart PartName="DgnPlatformDLL" PartFile="iModelCore/DgnPlatform/DgnPlatform" Repository="imodel02" />
        <SubPart PartName="ProfilesPublicAPI" />
        <Bindings>
            <Libs>
                Delivery/$(libprefix)Profiles$(libext)
            </Libs>
            <Assemblies>
                Delivery/$(shlibprefix)Profiles$(ApiNumber)$(shlibext)
            </Assemblies>
        </Bindings>
    </Part>

    <Part Name="ProfilesPublicAPI" BentleyBuildMakeFile="Profiles/ProfilesDomainDll.prewire.mke" ApiNumber="M02">
        <SubPart PartName="ProfilesSchema" PartFile="BisSchemas" Repository="BisSchemas" />
        <SubPart PartName="AecUnitsPublicAPI" Repository="imodel02" PartFile="Domains/AecUnits/AecUnits" />
        <Bindings>
            <PublicAPI Domain="Profiles" />
            <Directory SourceName="PublicAPI/Profiles" ProductDirectoryName="ProfilesIncludes" />
        </Bindings>
    </Part>

    <Part Name="ProfilesTests" BentleyBuildMakeFile="Tests/Tests.mke">
        <SubPart PartName="google_gtest_lib" PartFile="iModelCore/util/gtest/gtest" Repository="imodel02" />
        <SubPart PartName="DgnView" PartFile="DgnDisplay" Repository="DgnDisplay" />
        <SubPart PartName="DgnPlatformSqlang" PartFile="iModelCore/DgnPlatform/DgnPlatform" Repository="imodel02" />
        <SubPart PartName="ProfilesDomainDLL" />
        <Bindings>
            <Assemblies>Delivery/$(shlibprefix)ProfilesTests.exe</Assemblies>
            <Files ProductDirectoryName="ProfilesRoot">
                Delivery/ProfilesTests.logging.config.xml
                Delivery/ignore_list.txt
            </Files>
            <Files ProductDirectoryName="Assets" ProductSubDirectory="sqlang">
                Delivery/ProfilesTests_en-US.sqlang.db3
            </Files>
        </Bindings>
    </Part>

    <Part Name="RunProfilesTests" BentleyBuildMakeFile="$(BuildContext)/SubParts/BeGTest/gtest/RunGtest.mke" 
          BentleyBuildMakeOptions="-dGTEST_PRODUCT=ProfilesDomainTested\ -dGTEST_NAME=ProfilesTests" ExcludeLibType="Static">
        <SubPart PartName="Base" PartFile="iModelCore/BeGTest/BeGTest" Repository="imodel02" />
        <SubPart PartName="ProfilesTests" />
        <Bindings>
            <Files Required="false" SubPartDirectory="Gtest/Logs">
                Delivery/Gtest/Logs/ProfilesTests.log
            </Files>
        </Bindings>
    </Part>

    <Part Name="ProfilesDoc" BentleyBuildMakeFile="Profiles\Documentation\ProfilesDoc.mke">
        <RequiredRepository>Bsitools-Doxygen</RequiredRepository>
        <SubPart PartName="BentleyDocConfig" PartFile="iModelCore/DgnPlatform/DgnPlatform" Repository="imodel02" />
        <Bindings>
            <PublicAPI Domain="Profiles" />
            <Files ProductDirectoryName="ProfilesDocs">
                Delivery/Docs/*
            </Files>
        </Bindings>
    </Part>

    <!-- Not included in main build, run from shell 'bb -p ProfilesCodeCoverage p && bb -p ProfilesCodeCoverage b' to generate code coverage report. -->
    <Part Name="ProfilesCodeCoverage" BentleyBuildMakeFile="Tests/CodeCoverage.mke" >
        <RequiredRepository>Bsitools-OpenCppCoverage</RequiredRepository>
        <SubPart PartName="RunProfilesTests" />
    </Part>

    <ProductDirectoryList ListName="ProfilesTestsDirs">
        <ProductDirectory Name="VendorNotices"                  Deliver="false" />
        <ProductDirectory Name="Libs"                           Deliver="false" />
        <ProductDirectory Name="ProfilesIncludes"               Deliver="false" />
        <ProductDirectory Name="UnitTests-Assets"               Deliver="false" />
        <ProductDirectory Name="UnitTests-IgnoreList"           Deliver="false" />
        <ProductDirectory Name="UnitTests-Objects"              Deliver="false" />
    </ProductDirectoryList>

    <ProductDirectoryList ListName="ProfilesSDKDirs">
        <ProductDirectory Name="ProfilesRoot"                   Path="" />
        <ProductDirectory Name="Libs"                           RelativeTo="ProfilesRoot" Path="" />
        <ProductDirectory Name="Assemblies"                     RelativeTo="ProfilesRoot" Path="" />
        <ProductDirectory Name="ProfilesIncludes"               RelativeTo="ProfilesRoot" Path="Include/Profiles" />
        <ProductDirectory Name="ProfilesDocs"                   RelativeTo="ProfilesRoot" Path="Docs" />
        <ProductDirectory Name="VendorNotices"                  RelativeTo="ProfilesRoot" Path="VendorNotices" />
        <ProductDirectory Name="Assets"                         RelativeTo="ProfilesRoot" Path="Assets" />

        <ProductDirectory Name="VendorNotices"                  LibType="static" Deliver="false" />
        <ProductDirectory Name="Assets"                         LibType="static" Deliver="false" />
        <ProductDirectory Name="Assemblies"                     LibType="static" Deliver="false" />
    </ProductDirectoryList>

</BuildContext>
