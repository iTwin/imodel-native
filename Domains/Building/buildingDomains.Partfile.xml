<?xml version="1.0" encoding="utf-8"?>

<BuildContext xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="../../bsicommon/build/PartFile.xsd">

    <Part Name="BuildingDomains" PrgOutputDir="DesignModelingDomainsSDK">
        <SubPart PartName="RunBuildingDomainTests"/>
        <SubProduct ProductName="StructuralDomainsTested" PartFile="Domains/Structural/StructuralDomains" Repository="imodel02"/>
        <!-- <SubProduct ProductName="AecUnitsTests" PartFile="Domains/AecUnits/AecUnits" Repository="imodel02"/> -->
    </Part>

    <Part Name="DesignModelingSDKDistribution" PrgOutputDir="DesignModelingDomainsSDK">
        <SubPart PartName="BuildingDomains"/>
        <SubUPackProduct UPackProductName="DesignModelingSDKPackage"/>
    </Part>

    <!-- A convenience to platform developers that want to build platform and use Gist as their testbed. -->
    <Part Name="BuildingDomainsWithGist" PrgOutputDir="DgnClientSdk" Sequential="true">
        <SubPart PartName="DgnClientSdk-Tested" PartFile="DgnClientFx" Repository="DgnClientFx"/>
        <SubPart PartName="Gist" PartFile="Gist" Repository="Gist"/>
        <SubPart PartName="BuildingDomains"/>
    </Part>


    <Part Name="BuildingDomain" BentleyBuildMakeFile="Building.mke" ApiNumber="M02">
        <SubPart PartName="BuildingPhysicalPublicAPI"/>
        <SubPart PartName="AecUnitsDomain"             PartFile="Domains/AecUnits/AecUnits"              Repository="imodel02"/>
        <SubPart PartName="BuildingSpatialDomain" Repository="imodel02" PartFile="Domains/BuildingSpatial/BuildingSpatial" />
        <SubPart PartName="QuantityTakeoffsAspectsDomain" Repository="imodel02" PartFile="Domains/QuantityTakeoffsAspects/QuantityTakeoffsAspects" />
        <SubPart PartName="SpatialCompositionDomain" Repository="imodel02" PartFile="Domains/SpatialComposition/SpatialComposition" />
        <SubPart PartName="ClassificationSystemsDomain" Repository="imodel02" PartFile="Domains/ClassificationSystems/ClassificationSystems" />
        <SubPart PartName="GeometryManipulationStrategies" Repository="imodel02" PartFile="Domains/BuildingShared/BuildingShared" />
        <!--SubPart PartName="ConstraintModelSchema"      PartFile="ConstraintSystem"      Repository="DgnDomains-ConstraintSystem"/-->
        <SubPart PartName="Grids"                      PartFile="Domains/Grids/Grids"                 Repository="imodel02"/>
        <SubPart PartName="StructuralDomainDLL"        PartFile="Domains/Structural/StructuralDomains"     Repository="imodel02"/>
        <SubPart PartName="ProfilesDomainDLL"          PartFile="Domains/Profiles/ProfilesDomain"        Repository="imodel02"/>
        <SubPart PartName="FormsDomainDLL"             PartFile="Domains/Forms/FormsDomain"           Repository="imodel02"/>
        <SubPart PartName="DgnPlatformDLL"             PartFile="iModelCore/DgnPlatform/DgnPlatform"           Repository="imodel02" />
        <Bindings>
            <Libs>Delivery/$(libprefix)BuildingDomain$(libext)</Libs>
            <Assemblies>Delivery/$(shlibprefix)BuildingDomain$(ApiNumber)$(shlibext)</Assemblies>
        </Bindings>
    </Part>   


    <Part Name="BuildingPhysicalPublicAPI" BentleyBuildMakeFile="Building.prewire.mke" ApiNumber="M02">
        <Bindings>
            <PublicAPI Domain="BuildingDomain"/>
            <Files ProductDirectoryName="Assets" ProductSubDirectory="ECSchemas/Domain" SubPartDirectory="ECSchemas/Domain">
                ECSchemas/Domain/ArchitecturalPhysical.ecschema.xml
                ECSchemas/Domain/BuildingPhysical.ecschema.xml
            </Files>

          <!--  <Directory SourceName="Dox/Pages/Building"  SubPartDirectory="Dox/Pages/Building"/>
            <Directory SourceName="Dox/Images/Building" SubPartDirectory="Dox/Images/Building"/> -->
        </Bindings>
    </Part>

  <Part Name="ProfilesPublicAPI" BentleyBuildMakeFile="Profiles.prewire.mke" ApiNumber="M02">
    <Bindings>
      <PublicAPI Domain="ProfilesDomain"/>
      <Files ProductDirectoryName="Assets" ProductSubDirectory="ECSchemas/Domain" SubPartDirectory="ECSchemas/Domain">
        ECSchemas/Domain/Profiles.ecschema.xml
      </Files>

      <Directory SourceName="PublicApi/ProfilesDomain" ProductDirectoryName="ProfilesDomainIncludes" />
    </Bindings>
  </Part>
  
    <Part Name="BuildingDomainTestsExe" DeferType="BuildingDomainTests" BentleyBuildMakeFile="Tests/Tests.mke" OnlyPlatforms="x64">
        <SubPart PartName="google_gtest_lib"           PartFile="iModelCore/util/gtest/gtest"                 Repository="imodel02"  />
        <SubPart PartName="DgnPlatformSqlang"          PartFile="iModelCore/DgnPlatform/DgnPlatform"           Repository="imodel02" />
        <SubPart PartName="BuildingDomain"/>
        <SubPart PartName="StructuralDomainDLL"        PartFile="Domains/Structural/StructuralDomains"     Repository="imodel02"/>
        <SubPart PartName="ProfilesDomainDLL"          PartFile="Domains/Profiles/ProfilesDomain"        Repository="imodel02"/>
        <SubPart PartName="FormsDomainDLL"             PartFile="Domains/Forms/FormsDomain"           Repository="imodel02"/>
        <!--SubPart PartName="ConstraintModelSchema"      PartFile="ConstraintSystem"      Repository="DgnDomains-ConstraintSystem"/-->
        <SubPart PartName="Grids"                      PartFile="Domains/Grids/Grids"                 Repository="imodel02"/>
        <SubPart PartName="AecUnitsDomain"             PartFile="Domains/AecUnits/AecUnits"              Repository="imodel02"/>
        <Bindings>
              <Assemblies>Delivery/$(shlibprefix)BuildingDomainTests.exe</Assemblies>
              <Files ProductDirectoryName="Assets"> Delivery/BuildingDomainTests.logging.config.xml</Files>
              <Files ProductDirectoryName="Assets" ProductSubDirectory="sqlang">Delivery/BuildingDomainTests_en-US.sqlang.db3</Files>
        </Bindings>
    </Part>

    <ProductDirectoryList ListName="Tests">
        <ProductDirectory Name="VendorNotices"                  Path="VendorNotices"/>
        <ProductDirectory Name="Assemblies"                     Path="Assemblies"/>
        <ProductDirectory Name="Libs"                           Path="Libs"/>
        <ProductDirectory Name="Assets"                         Path="Assemblies/Assets"/>
        <ProductDirectory Name="IgnoreList"                     Path="Ignore"/>
        <ProductDirectory Name="DgnPlatformSqlang"              Path="sqlang"/>
        <ProductDirectory Name="UnitTests-Assets"               Deliver="false"/>
        <ProductDirectory Name="UnitTests-IgnoreList"           Deliver="false"/>
        <ProductDirectory Name="UnitTests-Objects"              Deliver="false"/>

        <!-- Adding these to silence the warnings... if you want them, deliver them properly... -->
        <ProductDirectory Name="Assemblies" LibType="static" Deliver="false"/>
        <ProductDirectory Name="VendorNotices" LibType="static" Deliver="false"/>
        <ProductDirectory Name="BuildingSharedIncludes" Deliver="false"/>
        <ProductDirectory Name="GridsIncludes" Deliver="false"/>
        <ProductDirectory Name="ProfilesIncludes" Deliver="false"/>
        <ProductDirectory Name="StructuralDomainIncludes" Deliver="false"/>
        <ProductDirectory Name="FormsDomainIncludes" Deliver="false"/>
        <ProductDirectory Name="BuildingDomainIncludes" Deliver="false"/>
        <ProductDirectory Name="ClassificationSystemsIncludes" Deliver="false"/>
        <ProductDirectory Name="QuantityTakeoffsAspectsIncludes" Deliver="false"/>
        <ProductDirectory Name="DgnV8Dlls" Deliver="false"/>
        <ProductDirectory Name="PublisherLoggingConfigXml" Deliver="false"/>
    </ProductDirectoryList>

    <Product Name="BuildingDomainTests" OnlyPlatforms="x64">
        <SubPart PartName="BuildingDomainTestsExe"/>
        <Directories DirectoryListName="Tests"/>
    </Product>

    <Part Name="RunBuildingDomainTests" DeferType="RunUnitTests" BentleyBuildMakeFile="$(BuildContext)/SubParts/BeGTest/gtest/RunGtest.mke" BentleyBuildMakeOptions="-dGTEST_PRODUCT=BuildingDomainTests\Assemblies\  -dGTEST_NAME=BuildingDomainTests" OnlyPlatforms="x64" ExcludeLibType="Static">
        <SubProduct ProductName="BuildingDomainTests" />
        <SubPart PartName="Base"    PartFile="iModelCore/BeGTest/BeGTest"   Repository="imodel02" />
        <Bindings>
            <Files Required="false" SubPartDirectory="Gtest/Logs">Delivery/Gtest/Logs/BuildingDomainTests.log</Files>
        </Bindings>
    </Part>

    <ProductDirectoryList ListName="DesignModelingDomainsSDK">
        <ProductDirectory Name="applicationroot"                                                        Path=""/>
        
        <ProductDirectory Name="Assemblies"                             RelativeTo="applicationroot"    Path="Assemblies"/>
        <ProductDirectory Name="Assets"                                 RelativeTo="applicationroot"    Path="Assets"/>
        <ProductDirectory Name="Assets" LibType="static"                RelativeTo="applicationroot"    Path="Assets"/>
        <ProductDirectory Name="ComponentAssets"                        RelativeTo="applicationroot"    Path="Assets"/>
        <ProductDirectory Name="Libs"                                   RelativeTo="applicationroot"    Path="lib/x64"/>
        <ProductDirectory Name="Libs" LibType="static"                  RelativeTo="applicationroot"    Path="lib/x64"/>
        <ProductDirectory Name="PublicAPI"                              RelativeTo="applicationroot"    Path="PublicAPI"/>
        <ProductDirectory Name="PublicAPI" LibType="static"             RelativeTo="applicationroot"    Path="PublicAPI"/>
        <ProductDirectory Name="PublisherLoggingConfigXml"              RelativeTo="applicationroot"    Path="Assets"/>
        <ProductDirectory Name="sqlang"                                 RelativeTo="Assets"             Path="sqlang"/>
        <ProductDirectory Name="sqlang" LibType="static"                RelativeTo="Assets"             Path="sqlang"/>
        <ProductDirectory Name="VendorAPI"                              RelativeTo="applicationroot"    Path="VendorAPI"/>
        <ProductDirectory Name="VendorNotices"                          RelativeTo="applicationroot"    Path="VendorNotices"/>
        <ProductDirectory Name="VendorNotices" LibType="static"         RelativeTo="applicationroot"    Path="VendorNotices"/>
    </ProductDirectoryList>

    <UPackProduct Name="DesignModelingSDKPackage" Description="DesignModelingSDKPackage"> 
        <SubPart PartName="AecUnitsDomain"                  PartFile="Domains/AecUnits/AecUnits"/>
        <SubPart PartName="BuildingDomain"/>
        <SubPart PartName="BuildingSpatialDomain"           PartFile="Domains/BuildingSpatial/BuildingSpatial"/>
        <SubPart PartName="ClassificationSystemsDomain"     PartFile="Domains/ClassificationSystems/ClassificationSystems"/>
        <SubPart PartName="DgnV8ConverterExe"               PartFile="iModelBridgeCore/DgnDbSync/DgnDbSync"/>
        <SubPart PartName="ElectricalDomains"               PartFile="Domains/Electrical/ElectricalDomains"/>
        <SubPart PartName="FormsDomainDLL"                  PartFile="Domains/Forms/FormsDomain"/>
        <SubPart PartName="Grids"                           PartFile="Domains/Grids/Grids"/>
        <SubPart PartName="ProfilesDomainDLL"               PartFile="Domains/Profiles/ProfilesDomain"/>
        <SubPart PartName="QuantityTakeoffsAspectsDomain"   PartFile="Domains/QuantityTakeoffsAspects/QuantityTakeoffsAspects"/>
        <SubPart PartName="SpatialCompositionDomain"        PartFile="Domains/SpatialComposition/SpatialComposition"/>
        <SubPart PartName="StructuralDomainDLL"             PartFile="Domains/Structural/StructuralDomains"/>

        <Directories DirectoryListName="DesignModelingDomainsSDK"/>
        <Directories DirectoryListName="DgnV8BridgeDirList" PartFile="iModelBridgeCore/DgnDbSync/DgnDbSync" Repository="imodel02"/>
        <Directories DirectoryListName="DesignModelingSDKPackageDirOverrides"/>
    </UPackProduct>
	
    <ProductDirectoryList ListName="DesignModelingSDKPackageDirOverrides">
        <ProductDirectory Name="applicationroot" Path="native"/>
    </ProductDirectoryList>

</BuildContext>
