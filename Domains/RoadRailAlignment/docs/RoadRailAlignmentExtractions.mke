#----------------------------------------------------------------------------------------
#
#     $Source: docs/RoadRailAlignmentExtractions.mke $
#
#  $Copyright: (c) 2016 Bentley Systems, Incorporated. All rights reserved. $
#
#----------------------------------------------------------------------------------------
%include mdl.mki

PublishExtractInput = $(OutputRootDir)build/RoadRailAlignment/PublishExtract/Input/
PublishExtractOutput = $(OutputRootDir)build/RoadRailAlignment/PublishExtract/Output/
PublishExtractStamp = $(PublishExtractOutput)PublishExtract.stamp

always:
    !~@mkdir ${PublishExtractInput}
    !~@mkdir ${PublishExtractOutput}

#----------------------------------------------------------------------------------------
#   Gather files that contain code samples into PublishExtractInput
#----------------------------------------------------------------------------------------
$(PublishExtractInput)Alignment.cpp : $(_MakeFilePath)../Alignment.cpp
    $(LinkFirstDepToFirstTarget)

#----------------------------------------------------------------------------------------
#   Extract the code samples into PublishExtractOutput
#----------------------------------------------------------------------------------------
%if defined (BMAKE_DELETE_ALL_TARGETS)
    cleanopt = --clean
%else
    cleanopt =
%endif

%if defined (VERBOSE)
    PUBLISH_VERBOSE = -v6
%else
    PUBLISH_VERBOSE = -v6   # INFO_LEVEL_VeryInteresting
%endif

always:
    PublishExtract.py -d${PublishExtractInput} $(PUBLISH_VERBOSE) $(cleanopt) -o${PublishExtractOutput} -s$(PublishExtractStamp) --noProvenance

#----------------------------------------------------------------------------------------
#   Link in code sample extractions for input into PublishApi by consuming SDKs
#----------------------------------------------------------------------------------------
$(BuildContext)Dox/Extractions/RoadRailAlignment : ${PublishExtractOutput}
    $(LinkFirstDepToFirstTargetAsDirectory)
