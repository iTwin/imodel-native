<?xml version="1.0" encoding="utf-8"?>

<BuildContext xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="../../bsicommon/build/PartFile.xsd">

    <!-- A convenience to platform developers that want to build platform and use Gist as their testbed. -->
    <Part Name="StructuralDomainsWithGist" PrgOutputDir="DgnClientSdk" Sequential="true">
        <SubPart PartName="DgnClientSdk-Tested" PartFile="DgnClientFx" Repository="DgnClientFx"/>
        <SubPart PartName="Gist" PartFile="Gist" Repository="Gist"/>
        <SubProduct ProductName="StructuralDomainsTested"/>
    </Part>

    <Product Name="StructuralDomainsSDK">
        <SubPart PartName="StructuralDomainDLL"/>
        <Directories DirectoryListName="StructuralDomainsSDKDirs"/>
    </Product>

    <Product Name="StructuralDomainsTested">
        <SubProduct ProductName="StructuralDomainsSDK"/>
        <SubPart PartName="RunStructuralDomainTests"/>
        <Directories DirectoryListName="StructuralDomainsSDKDirs"/>
        <Directories DirectoryListName="StructuralDomainsTestDirs"/>
    </Product>

    <Part Name="StructuralDomainPublicAPI" BentleyBuildMakeFile="Structural.prewire.mke" ApiNumber="M02">
        <Bindings>
            <PublicAPI Domain="StructuralDomain"/>
            <Files ProductDirectoryName="Assets" ProductSubDirectory="ECSchemas/Domain" SubPartDirectory="ECSchemas/Domain">
                ECSchemas/Domain/StructuralPhysical.ecschema.xml
            </Files>
        </Bindings>
    </Part>

    <Part Name="StructuralDomainDLL" BentleyBuildMakeFile="Structural.mke" ApiNumber="M02">
        <SubPart PartName="DgnPlatformDLL"  PartFile="iModelCore/DgnPlatform/DgnPlatform"  Repository="imodel02" />
        <!--TODO: references to Forms and Profiles commented out for EAP-->
        <!-- <SubPart PartName="ProfilesDomainDLL"  PartFile="Domains/Profiles/ProfilesDomain" Repository="imodel02" />
        <SubPart PartName="FormsDomainDLL"     PartFile="Domains/Forms/FormsDomain" Repository="imodel02" /> -->
        <SubPart PartName="StructuralDomainPublicAPI"/>
        <Bindings>
            <Libs>
                Delivery/$(libprefix)StructuralDomain$(libext)
            </Libs>
            <Assemblies>
                Delivery/$(shlibprefix)StructuralDomain$(ApiNumber)$(shlibext)
            </Assemblies>
        </Bindings>
    </Part>

    <Part Name="StructuralDomainTestsExe" DeferType="StructuralDomainTests" BentleyBuildMakeFile="Tests/Tests.mke">
        <SubPart PartName="google_gtest_lib"     PartFile="iModelCore/util/gtest/gtest"         Repository="imodel02"  />
        <SubPart PartName="DgnPlatformSqlang"    PartFile="iModelCore/DgnPlatform/DgnPlatform"   Repository="imodel02" />
        <SubPart PartName="StructuralDomainDLL"/>
        <Bindings>
            <Assemblies>Delivery/$(shlibprefix)StructuralDomainTests.exe</Assemblies>
            <Files ProductDirectoryName="StructuralDomainsRoot">
                Delivery/StructuralDomainTests.logging.config.xml
                Delivery/ignore_list.txt
            </Files>
            <Files ProductDirectoryName="Assets" ProductSubDirectory="sqlang">
                Delivery/StructuralDomainTests_en-US.sqlang.db3
            </Files>
        </Bindings>
    </Part>

    <Part Name="RunStructuralDomainTests" DeferType="RunUnitTests" BentleyBuildMakeFile="$(BuildContext)/SubParts/BeGTest/gtest/RunGtest.mke" 
          BentleyBuildMakeOptions="-dGTEST_PRODUCT=StructuralDomainsTested\  -dGTEST_NAME=StructuralDomainTests" ExcludeLibType="Static">
        <SubPart PartName="StructuralDomainTestsExe"/>
        <SubPart PartName="Base"    PartFile="iModelCore/BeGTest/BeGTest"   Repository="imodel02" />
        <Bindings>
            <Files Required="false" SubPartDirectory="Gtest/Logs">
                Delivery/Gtest/Logs/StructuralDomainTests.log
            </Files>
        </Bindings>
    </Part>

    <ProductDirectoryList ListName="StructuralDomainsTestDirs">
        <ProductDirectory Name="VendorNotices"                  Deliver="false" />
        <ProductDirectory Name="Libs"                           Deliver="false" />
        <ProductDirectory Name="StructuralDomainIncludes"       Deliver="false" />
        <ProductDirectory Name="FormsDomainIncludes"            Deliver="false" />
        <ProductDirectory Name="ProfilesDomainIncludes"         Deliver="false" />
        <ProductDirectory Name="UnitTests-Assets"               Deliver="false" />
        <ProductDirectory Name="UnitTests-IgnoreList"           Deliver="false" />
        <ProductDirectory Name="UnitTests-Objects"              Deliver="false" />
    </ProductDirectoryList>

    <ProductDirectoryList ListName="StructuralDomainsSDKDirs">
        <ProductDirectory Name="StructuralDomainsRoot"           Path=""/>
        <ProductDirectory Name="Assemblies"                      RelativeTo="StructuralDomainsRoot" Path=""/>
        <ProductDirectory Name="Assemblies"                      LibType="static" Deliver="false"/>
        <ProductDirectory Name="Libs"                            RelativeTo="StructuralDomainsRoot" Path=""/>
        <ProductDirectory Name="Assets"                          RelativeTo="StructuralDomainsRoot" Path="Assets"/>
        <ProductDirectory Name="Assets"                          LibType="static" Deliver="false" />
        <ProductDirectory Name="StructuralDomainIncludes"        RelativeTo="StructuralDomainsRoot" Path="Include/StructuralDomain"/>
        <ProductDirectory Name="ProfilesDomainIncludes"          RelativeTo="StructuralDomainsRoot" Path="Include/ProfilesDomain"/>
        <ProductDirectory Name="FormsDomainIncludes"             RelativeTo="StructuralDomainsRoot" Path="Include/FormsDomain"/>
        <ProductDirectory Name="VendorNotices"                   RelativeTo="StructuralDomainsRoot" Path="VendorNotices"/>
        <ProductDirectory Name="VendorNotices"                   LibType="static" RelativeTo="StructuralDomainsRoot" Path="VendorNotices"/>

    </ProductDirectoryList>

</BuildContext>
