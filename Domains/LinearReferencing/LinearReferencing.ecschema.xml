<?xml version="1.0" encoding="UTF-8"?>
<ECSchema schemaName="LinearReferencing" alias="lr" version="01.00.00" description="Base schema for Linear Referencing." xmlns="http://www.bentley.com/schemas/Bentley.ECXML.3.1">
    <ECSchemaReference name="BisCore" version="01.00.00" alias="bis"/>
    <ECSchemaReference name="AecUnits" version="01.00.00" alias="aecu"/>
    <ECEntityClass typeName="ILinearElement" description="Interface to be mixed-in by Element-subclasses meant to play the role of Linear-Elements." modifier="Abstract">
        <ECCustomAttributes>
            <IsMixin xmlns='CoreCustomAttributes.01.00'>
                <AppliesToEntityClass>bis:Element</AppliesToEntityClass>
            </IsMixin>
        </ECCustomAttributes>
        <ECNavigationProperty propertyName="ILinearElementSource" relationshipName="ILinearElementSourceProvidesILinearElements" direction="backward"/>
    </ECEntityClass>
    <ECEntityClass typeName="ILinearElementSource" description="Interface to be mixed-in by Element-subclasses meant to provide Linear-Elements." modifier="Abstract">
        <ECCustomAttributes>
            <IsMixin xmlns='CoreCustomAttributes.01.00'>
                <AppliesToEntityClass>bis:Element</AppliesToEntityClass>
            </IsMixin>
        </ECCustomAttributes>
    </ECEntityClass>
    <ECRelationshipClass typeName="ILinearElementSourceProvidesILinearElements" strength="referencing" modifier="None">
        <Source multiplicity="(0..1)" polymorphic="true" roleLabel="provided by 1 ILinearElementSource">
            <Class class="ILinearElementSource"/>
        </Source>
        <Target multiplicity="(0..*)" polymorphic="true" roleLabel="provides N ILinearElements">
            <Class class="ILinearElement"/>
        </Target>
    </ECRelationshipClass>
    
    <ECEntityClass typeName="ILinearlyLocated" modifier="Abstract">
        <ECCustomAttributes>
            <IsMixin xmlns='CoreCustomAttributes.01.00'>
                <AppliesToEntityClass>bis:Element</AppliesToEntityClass>
            </IsMixin>
        </ECCustomAttributes>
        <ECNavigationProperty propertyName="ILinearElement" relationshipName="ILinearlyLocatedAlongILinearElement" direction="forward">
            <ECCustomAttributes>
                <AutoHandledProperty>
                    <!-- 3 translates to "ReadOnly = Select|Insert" -->
                    <StatementTypes>3</StatementTypes>
                </AutoHandledProperty>
            </ECCustomAttributes>
        </ECNavigationProperty>
    </ECEntityClass>
    <ECRelationshipClass typeName="ILinearlyLocatedAlongILinearElement" strength="referencing" modifier="None">
        <Source multiplicity="(0..*)" polymorphic="true" roleLabel="is the axis for N linearly-located entities">
            <Class class="ILinearlyLocated"/>
        </Source>
        <Target multiplicity="(0..1)" polymorphic="true" roleLabel="N entities linearly located along 1 linear-element">
            <Class class="ILinearElement"/>
        </Target>
    </ECRelationshipClass>
    <ECEntityClass typeName="ILinearlyLocatedAttribution" description="Interface to be mixed-in by Element-subclasses representing properties that apply to only a portion of a Linear-Element-Source." modifier="Abstract">
        <BaseClass>ILinearlyLocated</BaseClass>
        <ECCustomAttributes>
            <IsMixin xmlns='CoreCustomAttributes.01.00'>
                <AppliesToEntityClass>bis:InformationContentElement</AppliesToEntityClass>
            </IsMixin>
        </ECCustomAttributes>
    </ECEntityClass>
    <ECEntityClass typeName="ILinearlyLocatedElement" description="Interface to be mixed-in by Element-subclasses located along a Linear-Element-Source." modifier="Abstract">
        <BaseClass>ILinearlyLocated</BaseClass>
        <ECCustomAttributes>
            <IsMixin xmlns='CoreCustomAttributes.01.00'>
                <AppliesToEntityClass>bis:GeometricElement</AppliesToEntityClass>
            </IsMixin>
        </ECCustomAttributes>
    </ECEntityClass>
    <ECEntityClass typeName="IReferent" description="Interface to be mixed-in by Element-subclasses that can play the role of a Referent (known location along a Linear-Element)." modifier="Abstract">
        <ECCustomAttributes>
            <IsMixin xmlns='CoreCustomAttributes.01.00'>
                <AppliesToEntityClass>bis:Element</AppliesToEntityClass>
            </IsMixin>
        </ECCustomAttributes>
    </ECEntityClass>
    <ECEntityClass typeName="LinearlyReferencedLocation" modifier="Abstract">
        <BaseClass>bis:ElementMultiAspect</BaseClass>
    </ECEntityClass>
    <ECRelationshipClass typeName="ILinearlyLocatedOwnsAtLocations" strength="embedding" modifier="None">
        <BaseClass>bis:ElementOwnsMultiAspects</BaseClass>
        <Source multiplicity="(1..1)" polymorphic="true" roleLabel="is owned by 1 ILinearlyLocated">
            <Class class="ILinearlyLocated"/>
        </Source>
        <Target multiplicity="(0..*)" polymorphic="false" roleLabel="owns N LinearlyReferencedLocations">
            <Class class="LinearlyReferencedAtLocation"/>
        </Target>
    </ECRelationshipClass>
    <ECRelationshipClass typeName="ILinearlyLocatedOwnsFromToLocations" strength="embedding" modifier="None">
        <BaseClass>bis:ElementOwnsMultiAspects</BaseClass>
        <Source multiplicity="(1..1)" polymorphic="true" roleLabel="is owned by 1 ILinearlyLocated">
            <Class class="ILinearlyLocated"/>
        </Source>
        <Target multiplicity="(0..*)" polymorphic="false" roleLabel="owns N LinearlyReferencedLocations">
            <Class class="LinearlyReferencedFromToLocation"/>
        </Target>
    </ECRelationshipClass>
    <ECStructClass typeName="DistanceExpression">
        <ECProperty propertyName="DistanceAlongFromStart" typeName="double" kindOfQuantity="aecu:LENGTH"/>
        <ECProperty propertyName="LateralOffsetFromILinearElement" typeName="double" kindOfQuantity="aecu:LENGTH"/>
        <ECProperty propertyName="VerticalOffsetFromILinearElement" typeName="double" kindOfQuantity="aecu:LENGTH"/>
        <ECProperty propertyName="DistanceAlongFromReferent" typeName="double" kindOfQuantity="aecu:LENGTH"/>
    </ECStructClass>
    <ECEntityClass typeName="LinearlyReferencedAtLocation" modifier="Sealed">
        <BaseClass>LinearlyReferencedLocation</BaseClass>
        <ECCustomAttributes>
            <ClassHasHandler xmlns="BisCore.01.00.00"/>
        </ECCustomAttributes>
        <ECStructProperty propertyName="AtPosition" typeName="DistanceExpression"/>
        <ECNavigationProperty propertyName="FromReferent" relationshipName="LinearlyReferencedAtPositionRefersToReferent" direction="Forward"/>
    </ECEntityClass>
    <ECEntityClass typeName="LinearlyReferencedFromToLocation" modifier="Sealed">
        <BaseClass>LinearlyReferencedLocation</BaseClass>
        <ECCustomAttributes>
            <ClassHasHandler xmlns="BisCore.01.00.00"/>
        </ECCustomAttributes>
        <ECStructProperty propertyName="FromPosition" typeName="DistanceExpression"/>
        <ECNavigationProperty propertyName="FromPositionFromReferent" relationshipName="LinearlyReferencedFromPositionRefersToReferent" direction="Forward"/>
        <ECStructProperty propertyName="ToPosition" typeName="DistanceExpression"/>
        <ECNavigationProperty propertyName="ToPositionFromReferent" relationshipName="LinearlyReferencedToPositionRefersToReferent" direction="Forward"/>
    </ECEntityClass>
    <ECRelationshipClass typeName="LinearlyReferencedAtPositionRefersToReferent" strength="referencing" modifier="None">
        <Source multiplicity="(0..*)" polymorphic="true" roleLabel="1 IReferent used to linearly-locate N locations">
            <Class class="LinearlyReferencedAtLocation"/>
        </Source>
        <Target multiplicity="(0..1)" polymorphic="true" roleLabel="N locations linearly located along 1 IReferent">
            <Class class="IReferent"/>
        </Target>
    </ECRelationshipClass>
    <ECRelationshipClass typeName="LinearlyReferencedFromPositionRefersToReferent" strength="referencing" modifier="None">
        <Source multiplicity="(0..*)" polymorphic="true" roleLabel="1 IReferent used to linearly-locate N locations">
            <Class class="LinearlyReferencedFromToLocation"/>
        </Source>
        <Target multiplicity="(0..1)" polymorphic="true" roleLabel="N locations linearly located along 1 IReferent">
            <Class class="IReferent"/>
        </Target>
    </ECRelationshipClass>
    <ECRelationshipClass typeName="LinearlyReferencedToPositionRefersToReferent" strength="referencing" modifier="None">
        <Source multiplicity="(0..*)" polymorphic="true" roleLabel="1 IReferent used to linearly-locate N locations">
            <Class class="LinearlyReferencedFromToLocation"/>
        </Source>
        <Target multiplicity="(0..1)" polymorphic="true" roleLabel="N locations linearly located along 1 IReferent">
            <Class class="IReferent"/>
        </Target>
    </ECRelationshipClass>
</ECSchema>
