<?xml version="1.0" encoding="utf-8"?>

<BuildContext xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="../bsicommon/build/PartFile.xsd">

  <Part Name="imodel-bank.Dev" PrgOutputDir="imodelbankaddon">
    <SubPart PartName="MakePackages"/>
  </Part>

  <Part Name="MakePackages" BentleyBuildMakeFile="makePackages.mke" OnlyPlatforms="x64,linuxX64,MacOSx64" PrgOutputDir="imodel-bank">
    <SubProduct ProductName="imodel-bank"/>
  </Part>

  <Product Name="imodel-bank">
    <SubProduct ProductName="imodel-bank-windows" />
    <SubProduct ProductName="imodel-bank-linux" />
    <SubProduct ProductName="imodel-bank-darwin" />
  </Product>

  <Product Name="imodel-bank-windows" OnlyPlatforms="x64">
    <SubPart PartName="imodel-bank-lib" LibType="Static" />
    <SubPart PartName="imodel-sqlang" LibType="Static" />
    <Directories DirectoryListName="imodel-bank-delivery-list" />
  </Product>

  <Product Name="imodel-bank-linux" OnlyPlatforms="Linux*">
    <SubPart PartName="imodel-bank-lib" LibType="Static" />
    <SubPart PartName="imodel-sqlang" LibType="Static" />
    <Directories DirectoryListName="imodel-bank-delivery-list" />
  </Product>

  <Product Name="imodel-bank-darwin" OnlyPlatforms="MacOSX64">
    <SubPart PartName="imodel-bank-lib" LibType="Static" />
    <SubPart PartName="imodel-sqlang" LibType="Static" />
    <Directories DirectoryListName="imodel-bank-delivery-list" />
  </Product>

  <ProductDirectoryList ListName="imodel-bank-delivery-list">
    <ProductDirectory Name="AddonRoot" Path="Addon" />
    <ProductDirectory Name="imodel_bank_node_module" RelativeTo="AddonRoot"/>
    <ProductDirectory Name="imodel_bank_node_module" RelativeTo="AddonRoot" LibType="Static" />
    <ProductDirectory Name="SupportingFilesRoot" Path="Support" />
    <ProductDirectory Name="Assemblies" Path="" RelativeTo="SupportingFilesRoot"/>
    <ProductDirectory Name="Assemblies" Deliver="false" LibType="Static"/>
    <ProductDirectory Name="Assets" Path="Assets" RelativeTo="SupportingFilesRoot"/>
    <ProductDirectory Name="Assets" Path="Assets" RelativeTo="SupportingFilesRoot" LibType="Static"/>

    <ProductDirectory Name="PresentationRules" Path="PresentationRules" RelativeTo="SupportingFilesRoot"/>
    <ProductDirectory Name="PresentationRules" Path="PresentationRules" RelativeTo="SupportingFilesRoot" LibType="Static"/>

    <ProductDirectory Name="VendorNotices"  RelativeTo="SupportingFilesRoot" Path="Notices"/>
    <ProductDirectory Name="VendorNotices"  RelativeTo="SupportingFilesRoot" Path="Notices" LibType="static"/>
  </ProductDirectoryList>

  <Part Name="imodel-bank-lib" BentleyBuildMakeFile="imodel-bank.mke" >
    <SubPart PartName="node-addon-api" Repository="Thirdparty-node-addon-api" PartFile="node-addon-api"/>
    <SubPart PartName="BeSQLite" PartFile="BeSQLite" Repository="BeSQLite"/>
    <SubPart PartName="GeomDlls" PartFile="geomlibs" Repository="GeomLibs" />
    <Bindings>
      <!-- KEEP THIS CONSISTENT WITH api_package\install-imodel-bank-native.js -->
      <Files ProductDirectoryName="imodel_bank_node_module" ProductSubDirectory="n_8">
        Delivery/imodel-bank/imodel-bank.node
      </Files>
    </Bindings>
  </Part>

  <Part Name="imodel-sqlang" BentleyBuildMakeFile="${SrcRoot}bsicommon/sqlang/mki/XliffsToDb.mke"
    BentleyBuildMakeOptions="-dSQLANG_OutputDb=$(OutputRootDir)build/imodel-bank/imodel-bank_en.sqlang.db3 -dSQLANG_XliffWildcard=$(BuildContext)Delivery/xliffs/*.xliff">
    <SubPart PartName="imodel-bank-lib" />
    <Bindings>
      <Files ProductDirectoryName="Assets" ProductSubDirectory="sqlang">Delivery/sqlang/imodel-bank_en.sqlang.db3</Files>
    </Bindings>
  </Part>

</BuildContext>
