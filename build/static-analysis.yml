# https://aka.ms/yaml

name: imodel02-stan-yaml-$(Date:yyyy.MM.dd)$(Rev:.r)
trigger: none

schedules:
  - cron: "0 3 * * Sun"
    displayName: Sunday 3:00 AM (UTC) weekly
    branches:
      include:
        - master

variables:
  BB_SRC_ROOT: $(Agent.BuildDirectory)/bbsrc
  WIP_STATIC_ANALYSIS: 1

jobs:
  # ================================================================================================
  - job: build_winx64
    displayName: Build Windows Desktop x64
    timeoutInMinutes: 240
    pool:
      name: iModelTechCI
      demands: 'Agent.OS -equals Windows_NT'
    variables:
      BB_ARCH: x64

    steps:
      - template: ./templates/prebuild.yml
      - script: python $(BB_SRC_ROOT)/imodel02/build/call_bb.py pull $(BB_V) -a $(BB_ARCH)
        displayName: Pull

      - script: python $(BB_SRC_ROOT)/imodel02/build/call_bb.py build $(BB_V) -a $(BB_ARCH)
        displayName: Build


