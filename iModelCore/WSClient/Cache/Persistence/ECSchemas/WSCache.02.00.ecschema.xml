<?xml version="1.0" encoding="UTF-8"?>
<ECSchema schemaName="WSCache" nameSpacePrefix="wsc" version="02.00" xmlns="http://www.bentley.com/schemas/Bentley.ECXML.3.0">
    <ECSchemaReference name="Bentley_Standard_CustomAttributes" version="01.12" prefix="bsca"/>
    <ECSchemaReference name="ECDb_FileInfo" version="02.00" prefix="ecdbf"/>
    <ECSchemaReference name="ECDbMap" version="01.00" prefix="ecdbmap"/>

    <ECEntityClass typeName="Node" modifier="Abstract">
        <ECCustomAttributes>
            <ClassMap xmlns="ECDbMap.01.00">
                <MapStrategy>
                    <Strategy>SharedTable</Strategy>
                    <AppliesToSubclasses>True</AppliesToSubclasses>
                </MapStrategy>
            </ClassMap>
        </ECCustomAttributes>
    </ECEntityClass>

    <ECEntityClass typeName="Root">
        <BaseClass>Node</BaseClass>
        <ECCustomAttributes>
            <ClassMap xmlns="ECDbMap.01.00">
                <Indexes>
                    <DbIndex>
                        <Name>WSC_Index_RootName</Name>
                        <IsUnique>True</IsUnique>
                        <Properties>
                            <string>Name</string>
                        </Properties>
                    </DbIndex>
                </Indexes>
            </ClassMap>
        </ECCustomAttributes>
        <ECProperty propertyName="Name" typeName="string"/>
        <ECProperty propertyName="Persistence" typeName="int"/>
        <ECProperty propertyName="SyncDate" typeName="dateTime">
            <ECCustomAttributes>
                <DateTimeInfo xmlns="Bentley_Standard_CustomAttributes.01.12">
                    <DateTimeKind>Utc</DateTimeKind>
                </DateTimeInfo>
            </ECCustomAttributes>
        </ECProperty>
    </ECEntityClass>

    <ECEntityClass typeName="NavigationBase">
        <BaseClass>Node</BaseClass>
    </ECEntityClass>

    <ECEntityClass typeName="Sequence">
        <ECProperty propertyName="LastChangeNumber" typeName="long"/>
        <ECProperty propertyName="LastCachedFileIndex" typeName="long"/>
    </ECEntityClass>

    <ECEntityClass typeName="InstanceBackup">
        <ECProperty propertyName="Instance" typeName="string"/>
    </ECEntityClass>

    <ECEntityClass typeName="ChangeInfo">
        <BaseClass>Node</BaseClass>
        <ECProperty propertyName="ChangeStatus" typeName="int"/>
        <ECProperty propertyName="SyncStatus" typeName="int"/>
        <ECProperty propertyName="ChangeNumber" typeName="long"/>
        <ECProperty propertyName="Revision" typeName="long"/>
        <ECProperty propertyName="IsLocal" typeName="boolean"/>
    </ECEntityClass>

    <ECEntityClass typeName="CachedFileInfo">
        <BaseClass>ChangeInfo</BaseClass>
        <ECProperty propertyName="CacheTag" typeName="string"/>
        <ECProperty propertyName="CacheDate" typeName="dateTime">
            <ECCustomAttributes>
                <DateTimeInfo xmlns="Bentley_Standard_CustomAttributes.01.12">
                    <DateTimeKind>Utc</DateTimeKind>
                </DateTimeInfo>
            </ECCustomAttributes>
        </ECProperty>
    </ECEntityClass>

    <ECEntityClass typeName="CachedObjectInfo">
        <BaseClass>ChangeInfo</BaseClass>
        <ECCustomAttributes>
            <ClassMap xmlns="ECDbMap.01.00">
                <Indexes>
                    <DbIndex>
                        <Name>WSC_Index_ClassIdAndRemoteId</Name>
                        <IsUnique>True</IsUnique>
                        <Properties>
                            <string>ClassId</string>
                            <string>RemoteId</string>
                        </Properties>
                    </DbIndex>
                    <DbIndex>
                        <Name>WSC_Index_ClassIdAndInstanceId</Name>
                        <IsUnique>True</IsUnique>
                        <Properties>
                            <string>ClassId</string>
                            <string>InstanceId</string>
                        </Properties>
                    </DbIndex>
                </Indexes>
            </ClassMap>
        </ECCustomAttributes>
        <ECProperty propertyName="ClassId" typeName="long"/>
        <ECProperty propertyName="InstanceId" typeName="long"/>
        <ECProperty propertyName="RemoteId" typeName="string"/>
        <ECProperty propertyName="InstanceState" typeName="int"/>
        <ECProperty propertyName="CacheTag" typeName="string"/>
        <ECProperty propertyName="CacheDate" typeName="dateTime">
            <ECCustomAttributes>
                <DateTimeInfo xmlns="Bentley_Standard_CustomAttributes.01.12">
                    <DateTimeKind>Utc</DateTimeKind>
                </DateTimeInfo>
            </ECCustomAttributes>
        </ECProperty>
    </ECEntityClass>

    <ECEntityClass typeName="CachedRelationshipInfo">
        <BaseClass>CachedObjectInfo</BaseClass>
        <ECCustomAttributes>
            <ClassMap xmlns="ECDbMap.01.00">
                <Indexes>
                    <DbIndex>
                        <Name>WSC_Index_ClassIdAndNonUniqueRemoteId</Name>
                        <IsUnique>False</IsUnique>
                        <Properties>
                            <string>ClassId</string>
                            <string>RemoteId</string>
                        </Properties>
                    </DbIndex>
                    <DbIndex>
                        <Name>WSC_Index_LocalRelationshipIdentifier</Name>
                        <IsUnique>True</IsUnique>
                        <Properties>
                            <string>ClassId</string>
                            <string>SourceClassId</string>
                            <string>SourceInstanceId</string>
                            <string>TargetClassId</string>
                            <string>TargetInstanceId</string>
                        </Properties>
                    </DbIndex>
                </Indexes>
            </ClassMap>
        </ECCustomAttributes>
        <ECProperty propertyName="RemoteId" typeName="string"/>
        <ECProperty propertyName="SourceClassId" typeName="long"/>
        <ECProperty propertyName="SourceInstanceId" typeName="long"/>
        <ECProperty propertyName="TargetClassId" typeName="long"/>
        <ECProperty propertyName="TargetInstanceId" typeName="long"/>
    </ECEntityClass>

    <ECEntityClass typeName="CachedResponseInfo">
        <BaseClass>Node</BaseClass>
        <ECCustomAttributes>
            <ClassMap xmlns="ECDbMap.01.00">
                <Indexes>
                    <DbIndex>
                        <Name>WSC_Index_QueryName</Name>
                        <IsUnique>False</IsUnique>
                        <Properties>
                            <string>Name</string>
                        </Properties>
                    </DbIndex>
                </Indexes>
            </ClassMap>
        </ECCustomAttributes>
        <ECProperty propertyName="Name" typeName="string"/>
        <ECProperty propertyName="AccessDate" typeName="dateTime">
            <ECCustomAttributes>
                <DateTimeInfo xmlns="Bentley_Standard_CustomAttributes.01.12">
                    <DateTimeKind>Utc</DateTimeKind>
                </DateTimeInfo>
            </ECCustomAttributes>
        </ECProperty>
        <ECProperty propertyName="IsCompleted" typeName="boolean"/>
    </ECEntityClass>

    <ECEntityClass typeName="CachedResponsePageInfo">
        <BaseClass>Node</BaseClass>
        <ECProperty propertyName="CacheDate" typeName="dateTime">
            <ECCustomAttributes>
                <DateTimeInfo xmlns="Bentley_Standard_CustomAttributes.01.12">
                    <DateTimeKind>Utc</DateTimeKind>
                </DateTimeInfo>
            </ECCustomAttributes>
        </ECProperty>
        <ECProperty propertyName="CacheTag" typeName="string"/>
        <ECProperty propertyName="Index" typeName="long"/>
    </ECEntityClass>

    <ECRelationshipClass typeName="RootToNode" strength="holding">
        <Source cardinality="(0,N)" polymorphic="false">
            <Class class="Root"/>
        </Source>
        <Target cardinality="(0,N)" polymorphic="false">
            <Class class="CachedObjectInfo"/>
            <Class class="NavigationBase"/>
        </Target>
    </ECRelationshipClass>

    <ECRelationshipClass typeName="RootToNodeWeak" strength="referencing">
        <Source cardinality="(0,N)" polymorphic="false">
            <Class class="Root"/>
        </Source>
        <Target cardinality="(0,N)" polymorphic="false">
            <Class class="CachedObjectInfo"/>
            <Class class="NavigationBase"/>
        </Target>
    </ECRelationshipClass>

    <ECRelationshipClass typeName="ResponseToParent" strength="referencing" strengthDirection="backward">
        <Source cardinality="(0,N)" polymorphic="false">
            <Class class="CachedResponseInfo"/>
        </Source>
        <Target cardinality="(1,1)" polymorphic="true">
            <Class class="Node"/>
        </Target>
    </ECRelationshipClass>

    <ECRelationshipClass typeName="ResponseToHolder" strength="holding" strengthDirection="backward">
        <Source cardinality="(0,N)" polymorphic="false">
            <Class class="CachedResponseInfo"/>
        </Source>
        <Target cardinality="(1,1)" polymorphic="true">
            <Class class="Node"/>
        </Target>
    </ECRelationshipClass>

    <ECRelationshipClass typeName="ResponseToResponsePage" strength="holding">
        <Source cardinality="(1,1)" polymorphic="false">
            <Class class="CachedResponseInfo"/>
        </Source>
        <Target cardinality="(0,N)" polymorphic="false">
            <Class class="CachedResponsePageInfo"/>
        </Target>
    </ECRelationshipClass>

    <ECRelationshipClass typeName="ResponsePageToResult" strength="holding">
        <Source cardinality="(0,N)" polymorphic="false">
            <Class class="CachedResponsePageInfo"/>
        </Source>
        <Target cardinality="(0,N)" polymorphic="false">
            <Class class="CachedObjectInfo"/>
            <Class class="CachedRelationshipInfo"/>
        </Target>
    </ECRelationshipClass>

    <ECRelationshipClass typeName="ResponsePageToResultWeak" strength="referencing">
        <Source cardinality="(0,N)" polymorphic="false">
            <Class class="CachedResponsePageInfo"/>
        </Source>
        <Target cardinality="(0,N)" polymorphic="false">
            <Class class="CachedObjectInfo"/>
            <Class class="CachedRelationshipInfo"/>
        </Target>
    </ECRelationshipClass>

    <ECRelationshipClass typeName="ChangeInfoToInstanceBackup" strength="holding">
        <Source cardinality="(1,1)" polymorphic="true">
            <Class class="ChangeInfo"/>
        </Source>
        <Target cardinality="(0,1)" polymorphic="false">
            <Class class="InstanceBackup"/>
        </Target>
    </ECRelationshipClass>

    <ECRelationshipClass typeName="ObjectInfoToCachedFileInfo" strength="holding">
        <Source cardinality="(1,1)" polymorphic="false">
            <Class class="CachedObjectInfo"/>
        </Source>
        <Target cardinality="(0,1)" polymorphic="false">
            <Class class="CachedFileInfo"/>
        </Target>
    </ECRelationshipClass>

    <ECRelationshipClass typeName="CachedFileInfoToFileInfo" strength="holding">
        <Source cardinality="(0,1)" polymorphic="false">
            <Class class="CachedFileInfo"/>
        </Source>
        <Target cardinality="(0,1)" polymorphic="false">
            <Class class="ecdbf:ExternalFileInfo"/>
        </Target>
    </ECRelationshipClass>

    <ECRelationshipClass typeName="CachedFileInfoToFileInfoOwnership" strength="holding">
        <Source cardinality="(0,1)" polymorphic="false">
            <Class class="CachedFileInfo"/>
        </Source>
        <Target cardinality="(0,1)" polymorphic="false">
            <Class class="ecdbf:FileInfoOwnership"/>
        </Target>
    </ECRelationshipClass>

    <ECEntityClass typeName="ExtendedData">
        <ECProperty propertyName="Content" typeName="string"/>
    </ECEntityClass>

    <ECRelationshipClass typeName="NodeToExtendedData" strength="embedding">
        <Source cardinality="(0,1)" polymorphic="true">
            <Class class="Node"/>
        </Source>
        <Target cardinality="(0,1)" polymorphic="false">
            <Class class="ExtendedData"/>
        </Target>
    </ECRelationshipClass>

</ECSchema>
