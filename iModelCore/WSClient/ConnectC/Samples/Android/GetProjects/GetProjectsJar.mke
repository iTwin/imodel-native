#--------------------------------------------------------------------------------------
#
#     $Source: ConnectC/Samples/Android/GetProjects/GetProjectsJar.mke $
#
#  $Copyright: (c) 2017 Bentley Systems, Incorporated. All rights reserved. $
#
#--------------------------------------------------------------------------------------
%include mdl.mki

#--------------------------------------------------------------------------------------
#   Check for environment dependencies
#--------------------------------------------------------------------------------------
%if $(TARGET_PLATFORM)!="Android"
    %error This makefile should be used only when TARGET_PLATFORM is Android
%endif

%if !defined (ANDROID_SDK_ROOT)
    %error Must set ANDROID_SDK_ROOT
%endif

#--------------------------------------------------------------------------------------
#   Set Variables
#--------------------------------------------------------------------------------------

DGNCLIENT_APP_ProjectRoot = $(_MakeFilePath)

buildOut = $(OutputRootDir)build/$(_MakeFileName)/
mavenDependenciesDirectory = $(BuildContext)SubParts/MavenDependencies/

#--------------------------------------------------------------------------------------
#   Use Gradle to build the DgnClientFx archive
#--------------------------------------------------------------------------------------
GRADLE_TASKS=clean assemble uploadArchives
GRADLE_PROPERTIES=buildDirectory=$[@subst \, \/, $(buildOut)] \
                  MavenDependenciesDirectory=$[@subst \, \/, $(mavenDependenciesDirectory)]

%include $(BuildContext)SubParts/AndroidTools/gradleBuild.mki

#--------------------------------------------------------------------------------------
#   Deliver the library's archive
#--------------------------------------------------------------------------------------
$(BuildContext)Delivery/mavenArchive/ : $(buildOut)/mavenArchive/
    $(LinkFirstDepToFirstTargetAsDirectory)
