<?xml version="1.0" encoding="utf-8"?>
<BuildContext
    xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
    xsi:noNamespaceSchemaLocation="../bsicommon/build/PartFile.xsd"
    >

    <!-- ======================================================================================================================================== -->
    <!-- == PUBLIC ============================================================================================================================== -->
    <!-- ======================================================================================================================================== -->

    <Part Name="iModelCorePRG" PrgOutputDir="iModelCore">
        <SubPart PartName="__iModelCorePRG-Dynamic"/>
        <SubPart PartName="__iModelCorePRG-Static"/>
    </Part>
    
    <!--
        iModelCore needs to include at least the platform SubParts required for the
        iModelJsNodeAddon. See iModelJsNodeAddon:iModelJsNodeAddonLibCommon.
     -->
    <Part Name="iModelCore">
        <SubPart PartName="DgnPlatformDLL" PartFile="iModelCore/DgnPlatform/DgnPlatform" Repository="imodel02"/>
        <SubPart PartName="ECPresentation" PartFile="iModelCore/ECPresentation/ECPresentation" Repository="imodel02"/>
        <SubPart PartName="ECObjectsNative" PartFile="iModelCore/ecobjects/ECObjects" Repository="imodel02"/>
        <SubPart PartName="iModelCoreSqlang" PartFile="iModelCore/DgnPlatform/iModelCoreL10N" Repository="imodel02"/>
    </Part>

    <Part Name="RunUnitTests" DeferType="RunUnitTests">
        <SubPart PartName="RunUnitGTest" PartFile="iModelCore/DgnPlatform/iModelCoreTesting" Repository="imodel02"/>
        <SubPart PartName="RunUnitJUnit" PartFile="iModelCore/DgnPlatform/iModelCoreTesting" Repository="imodel02"/>
        <SubPart PartName="RunUnitXCTest" PartFile="iModelCore/DgnPlatform/iModelCoreTesting" Repository="imodel02"/>
        <SubPart PartName="RunUnitCppTest" PartFile="iModelCore/DgnPlatform/iModelCoreTesting" Repository="imodel02"/>
    </Part>

    <!-- ======================================================================================================================================== -->
    <!-- == PRIVATE ============================================================================================================================= -->
    <!-- ======================================================================================================================================== -->

    <Part Name="__iModelCorePRG-Dynamic" OnlyPlatforms="x64,winrt*">
        <SubPart PartName="iModelCore" LibType="Dynamic"/>
        <SubPart PartName="RunUnitTests" LibType="Dynamic"/>
        <SubPart PartName="__ParasiteSubParts" LibType="Dynamic"/>
    </Part>

    <Part Name="__iModelCorePRG-Static" OnlyPlatforms="android*,ios*,macos*,linux*">
        <SubPart PartName="iModelCore" LibType="Static"/>
        <SubPart PartName="RunUnitTests" LibType="Static"/>
        <SubPart PartName="__ParasiteSubParts" LibType="Static"/>
    </Part>

    <!--
        These are "parasites" because they aren't strictly required for the iModelJsNodeAddon
        library itself. However, they may be required for its non-library parts of the build (e.g.
        testing, which we'd normally exclude from our build), or for other downstream builds
        pulling LKGs.
    -->
    <Part Name="__ParasiteSubParts">
        <!-- Testing -->
        <!-- .................................................................................. -->
        <SubPart PartName="__ParasiteSubParts_Gtest"/>
        <SubPart PartName="__ParasiteSubParts_JUnit"/>
        <SubPart PartName="__ParasiteSubParts_XCTest"/>
        <SubPart PartName="__ParasiteSubParts_CppTest"/>

        <!-- For DgnClientSdk -->
        <!-- .................................................................................. -->
        <SubPart PartName="BentleyDocConfig" PartFile="iModelCore/DgnPlatform/DgnPlatform" Repository="imodel02"/>
        <SubPart PartName="DgnPlatformExtractions" PartFile="iModelCore/DgnPlatform/DgnPlatform" Repository="imodel02"/>
        <SubPart PartName="Docs" PartFile="iModelCore/ECPresentation/ECPresentation" Repository="imodel02"/>

        <SubPart PartName="PerformanceTests" PartFile="iModelCore/ecobjects/ECObjects" Repository="imodel02"/>
        <SubPart PartName="UnitTests-Performance" PartFile="iModelCore/Bentley/Bentley" Repository="imodel02"/>
        <SubPart PartName="UnitTests-Performance" PartFile="iModelCore/DgnPlatform/DgnPlatform" Repository="imodel02"/>
        <SubPart PartName="UnitTests-Performance" PartFile="iModelCore/ECDb/ECDb" Repository="imodel02"/>
        <SubPart PartName="UnitTests-PerformanceTest" PartFile="iModelCore/GeomLibs/geomlibs" Repository="imodel02"/>

        <SubPart PartName="__ParasiteSubParts_DcsX64Parts"/>
    </Part>
    
    <Part Name="__ParasiteSubParts_Gtest" OnlyPlatforms="x64,macos*,linux*">
        <SubPart PartName="Gtest-Tools" PartFile="iModelCore/BeGTest/BeGTest" Repository="imodel02"/>
        <SubPart PartName="google_gmock_lib" PartFile="iModelCore/util/gmock/gmock" Repository="imodel02"/>
        <SubPart PartName="google_gtest_lib" PartFile="iModelCore/util/gtest/gtest" Repository="imodel02"/>
    </Part>

    <Part Name="__ParasiteSubParts_JUnit" OnlyPlatforms="android*">
        <SubPart PartName="AndroidJUnitTest-Tools" PartFile="iModelCore/BeGTest/BeGTest" Repository="imodel02"/>
    </Part>

    <Part Name="__ParasiteSubParts_XCTest" OnlyPlatforms="ios*">
        <SubPart PartName="iOSXCTest-Tools" PartFile="iModelCore/BeGTest/BeGTest" Repository="imodel02"/>
    </Part>

    <Part Name="__ParasiteSubParts_CppTest" OnlyPlatforms="winrt*">
        <SubPart PartName="UwpTest-Tools" PartFile="iModelCore/BeGTest/BeGTest" Repository="imodel02"/>
    </Part>

    <Part Name="__ParasiteSubParts_DcsX64Parts" OnlyPlatforms="x64">
        <SubProduct ProductName="IModelExtractor" PartFile="iModelCore/BeSQLite/IModelExtractor" Repository="imodel02"/>
        <SubProduct ProductName="iModelConsole" PartFile="iModelCore/DgnPlatform/DgnPlatform" Repository="imodel02"/>

        <SubPart PartName="NuGetPackage" PartFile="iModelCore/ecobjects/ecobjects" Repository="imodel02"/>
        <SubPart PartName="NuGetPackage" PartFile="iModelCore/ECDb/ecdb" Repository="imodel02"/>
        <SubPart PartName="NuGetPackage" PartFile="iModelCore/ECPresentation/ECPresentation" Repository="imodel02"/>
        <SubPart PartName="NuGetPackage" PartFile="iModelCore/DgnPlatform/dgnplatform" Repository="imodel02"/>
    </Part>

</BuildContext>
