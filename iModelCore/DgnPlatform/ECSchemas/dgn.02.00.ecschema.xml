<?xml version="1.0" encoding="utf-8"?>
<ECSchema schemaName="dgn" nameSpacePrefix="dgn" version="2.0"
xmlns="http://www.bentley.com/schemas/Bentley.ECXML.2.0"
xmlns:ecschema="http://www.bentley.com/schemas/Bentley.ECXML.2.0"
xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
xsi:schemaLocation="ecschema ECSchema.xsd" >

    <ECSchemaReference name="Bentley_Standard_CustomAttributes" version="01.12" prefix="bsca" />
    <ECSchemaReference name="ECDbMap" version="01.00" prefix="ecdbmap" />
    
    <!-- Applied to an ECClass to indicate that a subclass of DgnDomain::Handler will be supplied for it at run-time.
         It must be applied to any ECClass if the application/domain registers a Handler for that ECClass.
         It should not be applied to any other ECClass.
         It is an error to call RegisterHandler() with a handler for an ECClass which lacks this custom attribute. -->
    <ECClass typeName="ClassHasHandler" isCustomAttributeClass="True" description="Applied to an ECClass to indicate that a subclass of DgnDomain::Handler will be supplied for it at run-time.">
        <!-- Defines a list of names of actions which are prohibited when the associated handler is not available (e.g., because the DgnDomain is not loaded).
             Restrictions are inherited from superclasses; a subclass can only be as or more restrictive than its superclass, never less. -->
        <ECArrayProperty propertyName="Restrictions" typeName="string" description="List of actions which are not permitted when the associated handler is not available" minOccurs="0" maxOccurs="unbounded" />
    </ECClass>

    <!-- ////////////////////////////////////////////////////////////////////////////// -->
    <!-- // Geometry-related core classes -->
    <!-- ////////////////////////////////////////////////////////////////////////////// -->

    <ECClass typeName="ElementAlignedBox2d" isStruct="True">
        <ECProperty propertyName="Low" typeName="point2d" />
        <ECProperty propertyName="High" typeName="point2d" />
    </ECClass>
    <ECClass typeName="Placement2d" isStruct="True">
        <ECProperty propertyName="Origin" typeName="point2d" />
        <ECProperty propertyName="Rotation" typeName="double" />
        <ECStructProperty propertyName="Box" typeName="ElementAlignedBox2d" />
    </ECClass>

    <ECClass typeName="YawPitchRollAngles" isStruct="True">
        <ECProperty propertyName="Yaw" typeName="double" />
        <ECProperty propertyName="Pitch" typeName="double" />
        <ECProperty propertyName="Roll" typeName="double" />
    </ECClass>
    <ECClass typeName="ElementAlignedBox3d" isStruct="True">
        <ECProperty propertyName="Low" typeName="point3d" />
        <ECProperty propertyName="High" typeName="point3d" />
    </ECClass>
    <ECClass typeName="Placement3d" isStruct="True">
        <ECProperty propertyName="Origin" typeName="point3d" />
        <ECStructProperty propertyName="Rotation" typeName="YawPitchRollAngles" />
        <ECStructProperty propertyName="Box" typeName="ElementAlignedBox3d" />
    </ECClass>

    <ECClass typeName="GeometrySource" isDomainClass="False" isCustomAttributeClass="False" isStruct="False">
        <!-- abstract - interface adopted by Elements which have geometry. 
             NOTE: Derive from GeometrySource2d or GeometrySource3d. -->
        <ECProperty propertyName="CategoryId" typeName="long" /><!-- should be non-nullable but shared table... -->
        <ECProperty propertyName="Geometry" typeName="binary" />
    </ECClass>
    <ECClass typeName="GeometrySource2d" isDomainClass="False" isCustomAttributeClass="False" isStruct="False">
        <BaseClass>GeometrySource</BaseClass>
        <ECStructProperty propertyName="Placement" typeName="Placement2d" />
    </ECClass>
    <ECClass typeName="GeometrySource3d" isDomainClass="False" isCustomAttributeClass="False" isStruct="False">
        <BaseClass>GeometrySource</BaseClass>
        <ECStructProperty propertyName="Placement" typeName="Placement3d" />
        <ECProperty propertyName="InPhysicalSpace" typeName="boolean" />
    </ECClass>

    <!-- ////////////////////////////////////////////////////////////////////////////// -->
    <!-- // BIS-related core classes -->
    <!-- ////////////////////////////////////////////////////////////////////////////// -->

    <ECClass typeName="Authority" isDomainClass="True" >
        <!-- Authority for element codes and classifications -->
        <ECCustomAttributes>
            <ClassMap xmlns="ECDbMap.01.00">
                <MapStrategy>
                    <Strategy>SharedTable</Strategy>
                    <AppliesToSubclasses>True</AppliesToSubclasses>
                </MapStrategy>
                <ECInstanceIdColumn>Id</ECInstanceIdColumn>
            </ClassMap>
            <ClassHasHandler xmlns="dgn.02.00" />
        </ECCustomAttributes>
        <ECProperty propertyName="Name" typeName="string" description="Name of authority" >
            <ECCustomAttributes>
                <PropertyMap xmlns="ECDbMap.01.00">
                    <Collation>NoCase</Collation>
                    <IsNullable>False</IsNullable>
                    <IsUnique>True</IsUnique>
                </PropertyMap>
            </ECCustomAttributes>
        </ECProperty>
        <ECProperty propertyName="Props" typeName="string" description="Json string containing properties like URI" />
    </ECClass>
    <ECClass typeName="LocalAuthority" isDomainClass="True">
        <ECCustomAttributes>
            <ClassHasHandler xmlns="dgn.02.00" />
        </ECCustomAttributes>
        <BaseClass>Authority</BaseClass>
    </ECClass>
    <ECClass typeName="NamespaceAuthority" isDomainClass="True">
        <ECCustomAttributes>
            <ClassHasHandler xmlns="dgn.02.00" />
        </ECCustomAttributes>
        <BaseClass>Authority</BaseClass>
    </ECClass>

    <ECClass typeName="AuthorityIssuedCode" isStruct="True">
        <ECProperty propertyName="AuthorityId" typeName="long">
            <!-- Foreign key relationship: Authority.ECInstanceId -->
            <ECCustomAttributes>
                <PropertyMap xmlns="ECDbMap.01.00">
                    <IsNullable>False</IsNullable>
                    <IsUnique>False</IsUnique>
                </PropertyMap>
            </ECCustomAttributes>
        </ECProperty>
        <ECProperty propertyName="Namespace" typeName="string">
            <ECCustomAttributes>
                <PropertyMap xmlns="ECDbMap.01.00">
                    <IsNullable>False</IsNullable>
                    <Collation>NoCase</Collation>
                    <IsUnique>False</IsUnique>
                </PropertyMap>
            </ECCustomAttributes>
        </ECProperty>
        <ECProperty propertyName="Value" typeName="string">
            <!-- Note: use Code.[Value] in ECSql since "Value" is a reserved word -->
            <ECCustomAttributes>
                <PropertyMap xmlns="ECDbMap.01.00">
                    <IsNullable>True</IsNullable>
                    <Collation>NoCase</Collation>
                    <IsUnique>False</IsUnique>
                </PropertyMap>
            </ECCustomAttributes>
        </ECProperty>
    </ECClass>

    <ECRelationshipClass typeName="AuthorityIssuesElementCode" description="Element has a code which was issued by the given authority" isDomainClass="True" strengthDirection="forward" strength="referencing">
        <ECCustomAttributes>
            <ForeignKeyRelationshipMap xmlns="ECDbMap.01.00">
                <OnDeleteAction>NoAction</OnDeleteAction>
                <CreateIndex>False</CreateIndex><!-- We already index on Code -->
            </ForeignKeyRelationshipMap>
        </ECCustomAttributes>
        <Source cardinality="(1,1)" roleLabel="issues code" polymorphic="False">
            <Class class="Authority" />
        </Source>
        <Target cardinality="(0,N)" roleLabel="has N codes" polymorphic="True">
            <Class class="Element" >
                <Key>
                    <Property name="Code.AuthorityId" />
                </Key>
            </Class>
        </Target>
    </ECRelationshipClass>

    <ECRelationshipClass typeName="AuthorityIssuesModelCode" description="Model has a code which was issued by the given authority" isDomainClass="True" strengthDirection="forward" strength="referencing">
        <ECCustomAttributes>
            <ForeignKeyRelationshipMap xmlns="ECDbMap.01.00">
                <OnDeleteAction>NoAction</OnDeleteAction>
                <CreateIndex>False</CreateIndex><!-- We already index on Code -->
            </ForeignKeyRelationshipMap>
        </ECCustomAttributes>
        <Source cardinality="(1,1)" roleLabel="issues code" polymorphic="False">
            <Class class="Authority" />
        </Source>
        <Target cardinality="(0,N)" roleLabel="has N codes" polymorphic="True">
            <Class class="Model" >
                <Key>
                    <Property name="Code.AuthorityId" />
                </Key>
            </Class>
        </Target>
    </ECRelationshipClass>

    <ECClass typeName="Model" isDomainClass="True" >
        <!--WIP: make Model abstract? -->
        <ECCustomAttributes>
            <ClassHasHandler xmlns="dgn.02.00">
                <Restrictions>
                    <string>Clone</string><!-- It is never permitted to clone a model without its handler -->
                </Restrictions>
            </ClassHasHandler>
            <ClassMap xmlns="ECDbMap.01.00">
                <MapStrategy>
                    <Strategy>SharedTable</Strategy>
                    <AppliesToSubclasses>True</AppliesToSubclasses>
                </MapStrategy>
                <ECInstanceIdColumn>Id</ECInstanceIdColumn>
                <Indexes>
                    <DbIndex>
                        <Name>idx_dgn_Model_Code</Name>
                        <IsUnique>True</IsUnique>
                        <Properties>
                            <string>Code.AuthorityId</string>
                            <string>Code.Namespace</string>
                            <string>Code.Value</string>
                        </Properties>
                    </DbIndex>
                </Indexes>
            </ClassMap>
        </ECCustomAttributes>
        <ECStructProperty propertyName="Code" typeName="AuthorityIssuedCode" />
        <ECProperty propertyName="Label" displayLabel="Label" typeName="string" />
        <ECProperty propertyName="Properties" typeName="string" />
        <ECProperty propertyName="Visibility" typeName="int" />
        <ECProperty propertyName="DependencyIndex" typeName="int" />
    </ECClass>
    <ECClass typeName="GeometricModel" isDomainClass="False">
        <BaseClass>Model</BaseClass>
    </ECClass>
    <ECClass typeName="Model3d" isDomainClass="False">
        <BaseClass>GeometricModel</BaseClass>
    </ECClass>
    <ECClass typeName="Model2d" isDomainClass="True">
        <ECCustomAttributes>
            <ClassHasHandler xmlns="dgn.02.00" />
        </ECCustomAttributes>
        <BaseClass>GeometricModel</BaseClass>
        <ECProperty propertyName="GlobalOrigin" displayLabel="Global Origin" typeName="point2d" />
    </ECClass>
    <ECClass typeName="PhysicalModel" isDomainClass="True">
        <ECCustomAttributes>
            <ClassHasHandler xmlns="dgn.02.00" />
        </ECCustomAttributes>
        <BaseClass>Model3d</BaseClass>
    </ECClass>
    <ECClass typeName="PlanarPhysicalModel" isDomainClass="True">
        <ECCustomAttributes>
            <ClassHasHandler xmlns="dgn.02.00" />
        </ECCustomAttributes>
        <BaseClass>Model2d</BaseClass>
    </ECClass>
    <ECClass typeName="SectionDrawingModel" isDomainClass="True">
        <ECCustomAttributes>
            <ClassHasHandler xmlns="dgn.02.00" />
        </ECCustomAttributes>
        <BaseClass>PlanarPhysicalModel</BaseClass>
    </ECClass>
    <ECClass typeName="SheetModel" isDomainClass="True">
        <ECCustomAttributes>
            <ClassHasHandler xmlns="dgn.02.00" />
        </ECCustomAttributes>
        <BaseClass>Model2d</BaseClass>
        <ECProperty propertyName="SheetSize" displayLabel="Sheet Size" typeName="point2d" />
    </ECClass>
    <ECClass typeName="RedlineModel" isDomainClass="True">
        <ECCustomAttributes>
            <ClassHasHandler xmlns="dgn.02.00" />
        </ECCustomAttributes>
        <BaseClass>SheetModel</BaseClass>
    </ECClass>
    <ECClass typeName="PhysicalRedlineModel" isDomainClass="True">
        <ECCustomAttributes>
            <ClassHasHandler xmlns="dgn.02.00" />
        </ECCustomAttributes>
        <BaseClass>PhysicalModel</BaseClass>
    </ECClass>
    <ECClass typeName="ComponentModel" isDomainClass="True">
        <ECCustomAttributes>
            <ClassHasHandler xmlns="dgn.02.00" />
        </ECCustomAttributes>
        <BaseClass>Model3d</BaseClass>
        <ECProperty propertyName="Solver" typeName="string" />
        <!--  These are in the model's Props JSON
        <ECProperty propertyName="ItemECClass" typeName="string" description="Full name of ECClass of Item that is customized by this model"/>
        <ECProperty propertyName="ItemCategory" typeName="string" description="Name of Category used by harvestable Items in this model"/>
        <ECProperty propertyName="ItemCodeAuthority" typeName="string" description="Name of CodeAuthority to be used when creating component instances"/>
        -->
    </ECClass>
    <ECClass typeName="DefinitionModel" isDomainClass="True">
        <ECCustomAttributes>
            <ClassHasHandler xmlns="dgn.02.00" />
        </ECCustomAttributes>
        <BaseClass>Model</BaseClass>
    </ECClass>
    <ECClass typeName="DictionaryModel" isDomainClass="True">
        <ECCustomAttributes>
            <ClassHasHandler xmlns="dgn.02.00" />
        </ECCustomAttributes>
        <BaseClass>DefinitionModel</BaseClass>
    </ECClass>
    <ECClass typeName="WebMercatorModel" isDomainClass="True" >
        <ECCustomAttributes>
            <ClassHasHandler xmlns="dgn.02.00" />
        </ECCustomAttributes>
        <BaseClass>PhysicalModel</BaseClass>
    </ECClass>
    <ECClass typeName="StreetMapModel" isDomainClass="True" >
        <ECCustomAttributes>
            <ClassHasHandler xmlns="dgn.02.00" />
        </ECCustomAttributes>
        <BaseClass>WebMercatorModel</BaseClass>
    </ECClass>
    <ECClass typeName="SystemModel" isDomainClass="True" >
        <!-- A SystemModel contains SystemElements which are used to model functional systems -->
        <ECCustomAttributes>
            <ClassHasHandler xmlns="dgn.02.00" />
        </ECCustomAttributes>
        <BaseClass>Model</BaseClass>
    </ECClass>

    <ECRelationshipClass typeName="ModelContainsElements" description="Associates elements with a model" isDomainClass="True" strength="embedding">
        <ECCustomAttributes>
           <ForeignKeyRelationshipMap xmlns="ECDbMap.01.00">
                <OnDeleteAction>NoAction</OnDeleteAction>
            </ForeignKeyRelationshipMap>
        </ECCustomAttributes>
        <Source cardinality="(1,1)" roleLabel="is on 1 model" polymorphic="True">
            <Class class="Model" />
        </Source>
        <Target cardinality="(0,N)" roleLabel="has N elements" polymorphic="True">
          <Class class="Element" >
                <Key>
                    <Property name="ModelId" />
                </Key>
          </Class>
        </Target>
    </ECRelationshipClass>

    <ECClass typeName="Element" isDomainClass="False" isStruct="False" isCustomAttributeClass="False">
        <!-- Abstract -->
        <ECCustomAttributes>
            <ClassMap xmlns="ECDbMap.01.00">
                <MapStrategy>
                    <Strategy>SharedTable</Strategy>
                    <AppliesToSubclasses>True</AppliesToSubclasses>
                    <Options>JoinedTablePerDirectSubclass</Options>
                </MapStrategy>
                <ECInstanceIdColumn>Id</ECInstanceIdColumn>
                <Indexes>
                    <DbIndex>
                        <Name>idx_dgn_Element_Code</Name>
                        <IsUnique>True</IsUnique>
                        <Properties>
                            <string>Code.AuthorityId</string>
                            <string>Code.Namespace</string>
                            <string>Code.Value</string>
                        </Properties>
                    </DbIndex>
                    <DbIndex>
                        <!-- Index on ParentId -->
                        <Name>idx_dgn_Element_ParentId</Name>
                        <IsUnique>False</IsUnique>
                        <Properties>
                            <string>ParentId</string>
                        </Properties>
                        <Where>IndexedColumnsAreNotNull</Where>
                    </DbIndex>
                    <DbIndex>
                        <!-- Index on ModelId -->
                        <Name>idx_dgn_Element_ModelId</Name>
                        <IsUnique>False</IsUnique>
                        <Properties>
                            <string>ModelId</string>
                        </Properties>
                    </DbIndex>
                    <DbIndex>
                        <!-- Index on Label -->
                        <Name>idx_dgn_Element_Label</Name>
                        <IsUnique>False</IsUnique>
                        <Properties>
                            <string>Label</string>
                        </Properties>
                        <Where>IndexedColumnsAreNotNull</Where>
                    </DbIndex>
                </Indexes>
            </ClassMap>
            <ClassHasCurrentTimeStampProperty xmlns="Bentley_Standard_CustomAttributes.01.12">
                <PropertyName>LastMod</PropertyName>
            </ClassHasCurrentTimeStampProperty>
            <ClassHasHandler xmlns="dgn.02.00" />
        </ECCustomAttributes>
        <ECProperty propertyName="ModelId" typeName="long">
            <!-- Foreign key relationship: ModelContainsElements.ModelId -->
            <ECCustomAttributes>
                <PropertyMap xmlns="ECDbMap.01.00">
                    <IsNullable>False</IsNullable>
                </PropertyMap>
            </ECCustomAttributes>
        </ECProperty>
        <ECProperty propertyName="ParentId" typeName="long">
            <!-- Foreign key relationship: ElementOwnsChildElements.ParentId -->
            <ECCustomAttributes>
                <PropertyMap xmlns="ECDbMap.01.00">
                    <!-- Null means a "root level" element -->
                    <IsNullable>True</IsNullable>
                </PropertyMap>
            </ECCustomAttributes>
        </ECProperty>
        <ECStructProperty propertyName="Code" typeName="AuthorityIssuedCode" />
        <ECProperty propertyName="Label" typeName="string">
            <ECCustomAttributes>
                <PropertyMap xmlns="ECDbMap.01.00">
                    <IsNullable>True</IsNullable>
                    <Collation>NoCase</Collation>
                    <IsUnique>False</IsUnique>
                </PropertyMap>
            </ECCustomAttributes>
        </ECProperty>
        <ECProperty propertyName="LastMod" typeName="dateTime">
            <ECCustomAttributes>
                <DateTimeInfo xmlns="Bentley_Standard_CustomAttributes.01.12">
                    <DateTimeKind>Utc</DateTimeKind>
                </DateTimeInfo>
            </ECCustomAttributes>
        </ECProperty>
    </ECClass>

    <ECClass typeName="DefinitionElement" isDomainClass="False" isCustomAttributeClass="False" isStruct="False">
        <BaseClass>Element</BaseClass>
    </ECClass>
    <ECClass typeName="DictionaryElement" isDomainClass="False" isCustomAttributeClass="False" isStruct="False">
        <BaseClass>DefinitionElement</BaseClass>
    </ECClass>
    <ECClass typeName="SystemElement" isDomainClass="False" isCustomAttributeClass="False" isStruct="False">
        <!-- A SystemElement is used to model functional systems -->
        <BaseClass>Element</BaseClass>
    </ECClass>
    <ECClass typeName="SpatialElement" isDomainClass="False" isCustomAttributeClass="False" isStruct="False">
        <!-- An element that occupies real world space -->
        <BaseClass>Element</BaseClass>
        <BaseClass>GeometrySource3d</BaseClass>
        <ECProperty propertyName="REMOVE_THIS_PLEASE" typeName="string" /><!-- NEEDSWORK: ECDb will not create a table for SpatialElement even though it inherits additional properties from GeometrySource3d. Adding a direct property forces it to create the table -->
    </ECClass>
    <ECClass typeName="PhysicalElement" isDomainClass="True">
        <!-- A SpatialElement that has mass and can be "touched" -->
        <ECCustomAttributes>
            <ClassHasHandler xmlns="dgn.02.00" />
        </ECCustomAttributes>
        <BaseClass>SpatialElement</BaseClass>
    </ECClass>
    <ECClass typeName="SpatialLocationElement" isDomainClass="False" isCustomAttributeClass="False" isStruct="False">
        <!-- A SpatialElement that identifies a "tracked" real world location but has no mass and cannot be "touched" -->
        <BaseClass>SpatialElement</BaseClass>
    </ECClass>
    <ECClass typeName="SpatialGroupElement" isDomainClass="True">
        <!-- A SpatialElement that groups other SpatialElements using the ElementGroupsMembers relationship -->
        <ECCustomAttributes>
            <ClassHasHandler xmlns="dgn.02.00" />
        </ECCustomAttributes>
        <BaseClass>SpatialElement</BaseClass>
    </ECClass>
    <ECClass typeName="VolumeElement" isDomainClass="True" >
        <!-- A SpatialLocationElement that defines a volume -->
        <ECCustomAttributes>
            <ClassHasHandler xmlns="dgn.02.00" />
        </ECCustomAttributes>
        <BaseClass>SpatialLocationElement</BaseClass>
    </ECClass>
    <ECClass typeName="AnnotationElement" isDomainClass="True">
        <!-- 2D element used to annotate drawings and sheets -->
        <ECCustomAttributes>
            <ClassHasHandler xmlns="dgn.02.00" />
        </ECCustomAttributes>
        <BaseClass>Element</BaseClass>
        <BaseClass>GeometrySource2d</BaseClass>
    </ECClass>
    <ECClass typeName="DrawingElement" isDomainClass="True">
        <!-- 2D element used in drawings -->
        <ECCustomAttributes>
            <ClassHasHandler xmlns="dgn.02.00" />
        </ECCustomAttributes>
        <BaseClass>Element</BaseClass>
        <BaseClass>GeometrySource2d</BaseClass>
    </ECClass>
    <ECClass typeName="SheetElement" isDomainClass="True">
        <!-- 2D element used in sheets -->
        <ECCustomAttributes>
            <ClassHasHandler xmlns="dgn.02.00" />
        </ECCustomAttributes>
        <BaseClass>Element</BaseClass>
        <BaseClass>GeometrySource2d</BaseClass>
    </ECClass>

    <ECClass typeName="TextAnnotationData" isDomainClass="True">
        <ECCustomAttributes>
            <ClassHasHandler xmlns="dgn.02.00" />
        </ECCustomAttributes>
        <BaseClass>ElementUniqueAspect</BaseClass>
        <ECProperty propertyName="TextAnnotation" typeName="binary"/>
    </ECClass>
    <ECClass typeName="TextAnnotationElement" isDomainClass="True">
        <ECCustomAttributes>
            <ClassHasHandler xmlns="dgn.02.00" />
        </ECCustomAttributes>
        <BaseClass>AnnotationElement</BaseClass>
    </ECClass>
    <ECClass typeName="PhysicalTextAnnotationElement" isDomainClass="True">
        <ECCustomAttributes>
            <ClassHasHandler xmlns="dgn.02.00" />
        </ECCustomAttributes>
        <BaseClass>PhysicalElement</BaseClass>
    </ECClass>

    <ECClass typeName="AnnotationTableElement" isDomainClass="True">
        <!-- An AnnotationTableElement is an annotation element that displays a grid containing text and or graphics -->
        <ECCustomAttributes>
            <ClassHasHandler xmlns="dgn.02.00" />
        </ECCustomAttributes>
        <BaseClass>AnnotationElement</BaseClass>
    </ECClass>

    <ECClass typeName="AnnotationTableHeader" isDomainClass="True">
        <!-- The aspect that holds the header properties for an AnnotationTableElement -->
        <BaseClass>ElementUniqueAspect</BaseClass>
        <ECProperty propertyName="RowCount"                     typeName="int"/>
        <ECProperty propertyName="ColumnCount"                  typeName="int"/>
        <ECProperty propertyName="TextStyleId"                  typeName="long"/>
        <ECProperty propertyName="TitleRowCount"                typeName="int"/>
        <ECProperty propertyName="HeaderRowCount"               typeName="int"/>
        <ECProperty propertyName="FooterRowCount"               typeName="int"/>
        <ECProperty propertyName="HeaderColumnCount"            typeName="int"/>
        <ECProperty propertyName="FooterColumnCount"            typeName="int"/>
        <ECProperty propertyName="BreakType"                    typeName="int"/>
        <ECProperty propertyName="BreakPosition"                typeName="int"/>
        <ECProperty propertyName="BreakLength"                  typeName="double"/>
        <ECProperty propertyName="BreakGap"                     typeName="double"/>
        <ECProperty propertyName="RepeatHeaders"                typeName="boolean"/>
        <ECProperty propertyName="RepeatFooters"                typeName="boolean"/>
        <ECProperty propertyName="DefaultColumnWidth"           typeName="double"/>
        <ECProperty propertyName="DefaultRowHeight"             typeName="double"/>
        <ECProperty propertyName="DefaultMarginTop"             typeName="double"/>
        <ECProperty propertyName="DefaultMarginBottom"          typeName="double"/>
        <ECProperty propertyName="DefaultMarginLeft"            typeName="double"/>
        <ECProperty propertyName="DefaultMarginRight"           typeName="double"/>
        <ECProperty propertyName="DefaultCellAlignment"         typeName="int"/>
        <ECProperty propertyName="DefaultCellOrientation"       typeName="int"/>
        <ECProperty propertyName="FillSymbologyKeyOddRow"       typeName="int"/>
        <ECProperty propertyName="FillSymbologyKeyEvenRow"      typeName="int"/>
        <ECProperty propertyName="TitleRowTextStyle"            typeName="long"/>
        <ECProperty propertyName="HeaderRowTextStyle"           typeName="long"/>
        <ECProperty propertyName="FooterRowTextStyle"           typeName="long"/>
        <ECProperty propertyName="HeaderColumnTextStyle"        typeName="long"/>
        <ECProperty propertyName="FooterColumnTextStyle"        typeName="long"/>
        <ECProperty propertyName="BackupTextHeight"             typeName="double"/>
        <ECProperty propertyName="DataSourceProviderId"         typeName="long"/>
        <ECProperty propertyName="BodyTextHeight"               typeName="double"/>
        <ECProperty propertyName="TitleRowTextHeight"           typeName="double"/>
        <ECProperty propertyName="HeaderRowTextHeight"          typeName="double"/>
        <ECProperty propertyName="FooterRowTextHeight"          typeName="double"/>
        <ECProperty propertyName="HeaderColumnTextHeight"       typeName="double"/>
        <ECProperty propertyName="FooterColumnTextHeight"       typeName="double"/>
        <ECProperty propertyName="TextSymbKey"                  typeName="int"/>
    </ECClass>

    <ECClass typeName="AnnotationTableRow" isDomainClass="True">
        <!-- The aspect that holds properties of a row of an AnnotationTableElement -->
        <BaseClass>ElementMultiAspect</BaseClass>
        <ECCustomAttributes>
            <ClassMap xmlns="ECDbMap.01.00">
                <ECInstanceIdColumn>Id</ECInstanceIdColumn>
            </ClassMap>
        </ECCustomAttributes>
        <ECProperty propertyName="RowIndex"                     typeName="int"/>
        <ECProperty propertyName="HeightLock"                   typeName="boolean"/>
        <ECProperty propertyName="Height"                       typeName="double"/>
    </ECClass>

    <ECClass typeName="AnnotationTableColumn" isDomainClass="True">
        <!-- The aspect that holds properties of a column of an AnnotationTableElement -->
        <BaseClass>ElementMultiAspect</BaseClass>
        <ECCustomAttributes>
            <ClassMap xmlns="ECDbMap.01.00">
                <ECInstanceIdColumn>Id</ECInstanceIdColumn>
            </ClassMap>
        </ECCustomAttributes>
        <ECProperty propertyName="ColumnIndex"                  typeName="int"/>
        <ECProperty propertyName="WidthLock"                    typeName="boolean"/>
        <ECProperty propertyName="Width"                        typeName="double"/>
    </ECClass>

    <ECClass typeName="AnnotationTableCellIndex" isStruct="True">
        <ECProperty propertyName="RowIndex"                     typeName="int"/>
        <ECProperty propertyName="ColumnIndex"                  typeName="int"/>
    </ECClass>

    <ECClass typeName="AnnotationTableCell" isDomainClass="True">
        <!-- The aspect that holds properties of a cell of an AnnotationTableElement -->
        <BaseClass>ElementMultiAspect</BaseClass>
        <ECCustomAttributes>
            <ClassMap xmlns="ECDbMap.01.00">
                <ECInstanceIdColumn>Id</ECInstanceIdColumn>
            </ClassMap>
        </ECCustomAttributes>
        <ECStructProperty propertyName="CellIndex"              typeName="AnnotationTableCellIndex"/>
        <ECProperty propertyName="TextBlock"                    typeName="binary"/>
        <ECProperty propertyName="FillKey"                      typeName="int"/>
        <ECProperty propertyName="Alignment"                    typeName="int"/>
        <ECProperty propertyName="Orientation"                  typeName="int"/>
        <ECProperty propertyName="MarginTop"                    typeName="double"/>
        <ECProperty propertyName="MarginBottom"                 typeName="double"/>
        <ECProperty propertyName="MarginLeft"                   typeName="double"/>
        <ECProperty propertyName="MarginRight"                  typeName="double"/>
    </ECClass>

    <ECClass typeName="AnnotationTableMerge" isDomainClass="True">
        <!-- The aspect that holds properties describing merging of cells in an AnnotationTableElement -->
        <BaseClass>ElementMultiAspect</BaseClass>
        <ECCustomAttributes>
            <ClassMap xmlns="ECDbMap.01.00">
                <ECInstanceIdColumn>Id</ECInstanceIdColumn>
            </ClassMap>
        </ECCustomAttributes>
        <ECStructProperty propertyName="RootCell"               typeName="AnnotationTableCellIndex"/>
        <ECProperty propertyName="RowSpan"                      typeName="int"/>
        <ECProperty propertyName="ColumnSpan"                   typeName="int"/>
    </ECClass>

    <ECClass typeName="AnnotationTableSymbology" isDomainClass="True">
        <!-- The aspect that holds properties describing symbology in an AnnotationTableElement -->
        <BaseClass>ElementMultiAspect</BaseClass>
        <ECCustomAttributes>
            <ClassMap xmlns="ECDbMap.01.00">
                <ECInstanceIdColumn>Id</ECInstanceIdColumn>
            </ClassMap>
        </ECCustomAttributes>
        <ECProperty propertyName="SymbologyKey"                 typeName="int"/>
        <ECProperty propertyName="Visible"                      typeName="boolean"/>
        <ECProperty propertyName="Color"                        typeName="int"/>
        <ECProperty propertyName="Weight"                       typeName="int"/>
        <ECProperty propertyName="LineStyleId"                  typeName="long"/>
        <ECProperty propertyName="LineStyleScale"               typeName="double"/>
        <ECProperty propertyName="FillColor"                    typeName="int"/>
    </ECClass>

    <ECClass typeName="AnnotationTableEdgeRun" isDomainClass="True">
        <!-- The aspect that holds properties describing edges in an AnnotationTableElement -->
        <BaseClass>ElementMultiAspect</BaseClass>
        <ECCustomAttributes>
            <ClassMap xmlns="ECDbMap.01.00">
                <ECInstanceIdColumn>Id</ECInstanceIdColumn>
            </ClassMap>
        </ECCustomAttributes>
        <ECProperty propertyName="HostType"                     typeName="int"/>
        <ECProperty propertyName="Host"                         typeName="int"/>
        <ECProperty propertyName="Start"                        typeName="int"/>
        <ECProperty propertyName="Span"                         typeName="int"/>
        <ECProperty propertyName="SymbologyKey"                 typeName="int"/>
    </ECClass>

    <ECClass typeName="ViewAttachmentElement" isDomainClass="True">
        <!-- A reference to a ViewDefinition, placed onto a sheet -->
        <ECCustomAttributes>
            <ClassHasHandler xmlns="dgn.02.00" />
        </ECCustomAttributes>
        <BaseClass>SheetElement</BaseClass>
        <ECProperty propertyName="ViewId" typeName="long">
            <!-- Foreign key relationship: ViewIsAttached.ViewId -->
            <!-- Should have IsNullable=False but shared table... -->
        </ECProperty>
        <ECProperty propertyName="Scale" typeName="double">
            <!-- Should have IsNullable=False but shared table... -->
        </ECProperty>
    </ECClass>
    <ECRelationshipClass typeName="ViewIsAttached" isDomainClass="True" strengthDirection="forward" strength="embedding">
        <ECCustomAttributes>
            <ForeignKeyRelationshipMap xmlns="ECDbMap.01.00">
                <OnDeleteAction>Cascade</OnDeleteAction>
                <CreateIndex>True</CreateIndex>
            </ForeignKeyRelationshipMap>
        </ECCustomAttributes>
        <Source cardinality="(1,1)" roleLabel="is referenced by" polymorphic="True">
            <Class class="ViewDefinition" />
        </Source>
        <Target cardinality="(1,1)" roleLabel="references" polymorphic="True">
            <Class class="ViewAttachmentElement">
                <Key>
                    <Property name="ViewId" />
                </Key>
            </Class>
        </Target>
    </ECRelationshipClass>

    <!-- An Item in (a catalog/template model) can hold a soultion of a ComponentModel. 
        There can be many Items, each holding a different solution (based on a unique set of parameters), of a single ComponentModel. 
        There can be many different ComponentModels.
    -->
    <ECRelationshipClass typeName="SolutionOfComponent" isDomainClass="True" strength="referencing" strengthDirection="forward">
        <Source cardinality="(0,N)" roleLabel="many unique solutions" polymorphic="True">
            <Class class="Element" />
        </Source>
        <Target cardinality="(0,N)" roleLabel="of a ComponentModel" polymorphic="True">
            <Class class="ComponentModel" />
        </Target>
        <!-- JSON representation of parameters that were used to solve the target model in order to produce the source element -->
        <ECProperty propertyName="Parameters" typeName="string"/>
    </ECRelationshipClass>

    <!-- An Item can be a copy of a (template) Item. 
        There can be many copies of a single template Item. 
        There can be many different template Items. 
    -->
    <ECRelationshipClass typeName="InstantiationOfTemplate" isDomainClass="True" strength="referencing" strengthDirection="forward">
        <ECCustomAttributes>
            <ClassMap xmlns="ECDbMap.01.00">
                <ECInstanceIdColumn>Id</ECInstanceIdColumn>
            </ClassMap>
            <LinkTableRelationshipMap xmlns="ECDbMap.01.00">
                <SourceECInstanceIdColumn>InstanceId</SourceECInstanceIdColumn>
                <TargetECInstanceIdColumn>TemplateId</TargetECInstanceIdColumn>
            </LinkTableRelationshipMap>
        </ECCustomAttributes>
        <Source cardinality="(0,N)" roleLabel="many instances" polymorphic="True">
            <Class class="Element" />
        </Source>
        <Target cardinality="(0,N)" roleLabel="of one template" polymorphic="True">
            <Class class="Element"/>
        </Target>
    </ECRelationshipClass>

    <ECRelationshipClass typeName="ElementOwnsChildElements" isDomainClass="True" strength="embedding" strengthDirection="forward">
        <ECCustomAttributes>
            <ForeignKeyRelationshipMap xmlns="ECDbMap.01.00">
                <!-- Deleting a parent element should delete its children -->
                <OnDeleteAction>Cascade</OnDeleteAction>
            </ForeignKeyRelationshipMap>
        </ECCustomAttributes>
        <Source cardinality="(1,1)" roleLabel="is on 1 element" polymorphic="True">
            <Class class="Element" />
        </Source>
        <Target cardinality="(0,N)" roleLabel="is on N elements" polymorphic="True">
            <Class class="Element" >
                <Key>
                    <Property name="ParentId"/>
                </Key>
            </Class>
        </Target>
    </ECRelationshipClass>

    <ECRelationshipClass typeName="ElementGroupsMembers" isDomainClass="True" strength="referencing" strengthDirection="forward">
        <ECCustomAttributes>
            <ClassMap xmlns="ECDbMap.01.00">
                <ECInstanceIdColumn>Id</ECInstanceIdColumn>
            </ClassMap>
            <LinkTableRelationshipMap xmlns="ECDbMap.01.00">
                <SourceECInstanceIdColumn>GroupId</SourceECInstanceIdColumn>
                <TargetECInstanceIdColumn>MemberId</TargetECInstanceIdColumn>
            </LinkTableRelationshipMap>
        </ECCustomAttributes>
        <Source cardinality="(0,N)" polymorphic="True">
            <Class class="Element" />
        </Source>
        <Target cardinality="(0,N)" polymorphic="True">
            <Class class="Element" />
        </Target>
    </ECRelationshipClass>

    <ECClass typeName="ElementAspect" isDomainClass="False" isStruct="False" isCustomAttributeClass="False">
        <!-- Abstract -->
        <!-- An ElementAspect is related to an Element with a relationship of strength="embedding" (ElementAspect is deleted if the Element is deleted) -->
        <!-- Semantically, an ElementAspect can be considered part of the Element -->
        <ECCustomAttributes>
            <ClassMap xmlns="ECDbMap.01.00">
                <ECInstanceIdColumn>ElementId</ECInstanceIdColumn>
            </ClassMap>
            <ClassHasHandler xmlns="dgn.02.00" />
        </ECCustomAttributes>
    </ECClass>

    <ECClass typeName="ElementUniqueAspect" isDomainClass="False" isStruct="False" isCustomAttributeClass="False">
        <!-- An ElementUniqueAspect is related to an Element with the following constraints: 1) there can only be one instance of a given aspect class associated with a given element, and 2) the instance has the same ID as the element. -->
        <BaseClass>ElementAspect</BaseClass>
        <ECCustomAttributes>
            <ClassMap xmlns="ECDbMap.01.00">
                <MapStrategy>
                    <!-- Each ElementUniqueAspect subclass should have its own table -->
                    <Strategy>OwnTable</Strategy>
                    <!-- Each ElementUniqueAspect subclass should determine its own MapStrategy -->
                    <AppliesToSubclasses>False</AppliesToSubclasses>
                </MapStrategy>
                <!-- The ECInstanceId for ElementUniqueAspect is the same as the Id of the owning Element -->
                <ECInstanceIdColumn>ElementId</ECInstanceIdColumn>
            </ClassMap>
        </ECCustomAttributes>
    </ECClass>

    <ECClass typeName="ElementMultiAspect" isDomainClass="False" isStruct="False" isCustomAttributeClass="False">
        <!-- An ElementMultiAspect is related to an Element with the following constraints: 1) there can be N instances of a given aspect class associated with a given element, and 2) the value of the ElementId foreign key column is the same ID as the element. -->
        <BaseClass>ElementAspect</BaseClass>
        <ECCustomAttributes>
            <ClassMap xmlns="ECDbMap.01.00">
                <MapStrategy>
                    <!-- Each ElementMultiAspect subclass should have its own table -->
                    <Strategy>OwnTable</Strategy>
                    <!-- Each ElementMultiAspect subclass should determine its own MapStrategy -->
                    <AppliesToSubclasses>False</AppliesToSubclasses>
                </MapStrategy>
                <ECInstanceIdColumn>Id</ECInstanceIdColumn>
            </ClassMap>
        </ECCustomAttributes>
        <ECProperty propertyName="ElementId" typeName="long">
            <!-- Foreign key relationship to Element that owns the aspect -->
            <ECCustomAttributes>
                <PropertyMap xmlns="ECDbMap.01.00">
                    <IsNullable>False</IsNullable>
                </PropertyMap>
            </ECCustomAttributes>
        </ECProperty>
    </ECClass>

    <ECClass typeName="ElementExternalKey" isDomainClass="True" >
        <!-- The aspect that holds an identifier from an external system -->
        <BaseClass>ElementMultiAspect</BaseClass>
        <ECCustomAttributes>
            <ClassMap xmlns="ECDbMap.01.00">
                <MapStrategy>
                    <!-- All subclasses of ElementExternalKey will share the same table -->
                    <Strategy>SharedTable</Strategy>
                    <Options>SharedColumnsForSubclasses</Options>
                    <AppliesToSubclasses>True</AppliesToSubclasses>
                </MapStrategy>
                <ECInstanceIdColumn>Id</ECInstanceIdColumn>
                <Indexes>
                    <DbIndex>
                        <IsUnique>True</IsUnique>
                        <Properties>
                            <!-- Only one ExternalKey per Authority per Element -->
                            <string>ElementId</string>
                            <string>AuthorityId</string>
                        </Properties>
                    </DbIndex>
                    <DbIndex>
                        <!-- Index for looking up Element by ExternalKey -->
                        <!-- WIP: IsUnique=False to support ExternalKeys for types (multiple Elements have same ExternalKey) -->
                        <IsUnique>False</IsUnique>
                        <Properties>
                            <string>AuthorityId</string>
                            <string>ExternalKey</string>
                        </Properties>
                    </DbIndex>
                </Indexes>
            </ClassMap>
        </ECCustomAttributes>
        <ECProperty propertyName="AuthorityId" typeName="long">
            <!-- Foreign key relationship to Authority that controls the ExternalKey -->
            <ECCustomAttributes>
                <PropertyMap xmlns="ECDbMap.01.00">
                    <IsNullable>False</IsNullable>
                </PropertyMap>
            </ECCustomAttributes>
        </ECProperty>
        <ECProperty propertyName="ExternalKey" typeName="string">
            <ECCustomAttributes>
                <PropertyMap xmlns="ECDbMap.01.00">
                    <IsNullable>False</IsNullable>
                </PropertyMap>
            </ECCustomAttributes>
        </ECProperty>
    </ECClass>
    <ECRelationshipClass typeName="ElementOwnsExternalKey" isDomainClass="True" strength="embedding" strengthDirection="forward">
        <ECCustomAttributes>
            <ForeignKeyRelationshipMap xmlns="ECDbMap.01.00">
                <OnDeleteAction>Cascade</OnDeleteAction>
            </ForeignKeyRelationshipMap>
        </ECCustomAttributes>
        <Source cardinality="(1,1)" polymorphic="True">
            <Class class="Element" />
        </Source>
        <Target cardinality="(0,N)" polymorphic="True">
            <Class class="ElementExternalKey">
                <Key>
                    <Property name="ElementId"/>
                </Key>
            </Class>
        </Target>
    </ECRelationshipClass>

    <ECClass typeName="ElementDescription" isDomainClass="True" >
        <!-- The aspect that holds a descriptions of an element -->
        <BaseClass>ElementUniqueAspect</BaseClass>
        <ECCustomAttributes>
            <ClassMap xmlns="ECDbMap.01.00">
                <!-- The ECInstanceId for ElementDescription is the same as the Id of the owning Element -->
                <ECInstanceIdColumn>ElementId</ECInstanceIdColumn>
            </ClassMap>
        </ECCustomAttributes>
        <ECProperty propertyName="Descr" displayLabel="Description" typeName="string">
            <ECCustomAttributes>
                <PropertyMap xmlns="ECDbMap.01.00">
                    <IsNullable>False</IsNullable>
                </PropertyMap>
            </ECCustomAttributes>
        </ECProperty>
    </ECClass>
    <ECRelationshipClass typeName="ElementOwnsDescription" isDomainClass="True" strength="embedding" strengthDirection="forward">
        <ECCustomAttributes>
            <ForeignKeyRelationshipMap xmlns="ECDbMap.01.00">
                <OnDeleteAction>Cascade</OnDeleteAction>
            </ForeignKeyRelationshipMap>
        </ECCustomAttributes>
        <Source cardinality="(1,1)" polymorphic="True">
            <Class class="Element" />
        </Source>
        <Target cardinality="(0,N)" polymorphic="True">
            <Class class="ElementDescription">
                <Key>
                    <Property name="ECInstanceId"/>
                </Key>
            </Class>
        </Target>
    </ECRelationshipClass>

    <ECRelationshipClass typeName="ElementDrivesElement" isDomainClass="True" strength="referencing" strengthDirection="forward">
        <!-- Relationship that indicates that an Element drives (controls the lifecyle or structure of) a dependent Element -->
        <ECCustomAttributes>
            <ClassHasHandler xmlns="dgn.02.00" />
            <ClassMap xmlns="ECDbMap.01.00">
                <!-- We must insist that all instances of all possible subclasses are stored together in a single table. 
                     TxnManager knows about this table, and expects to find all instances this kind of relationship there. -->
                <MapStrategy>
                    <Strategy>SharedTable</Strategy>
                    <AppliesToSubclasses>True</AppliesToSubclasses>
                </MapStrategy>
            </ClassMap>
            <LinkTableRelationshipMap xmlns="ECDbMap.01.00">
                <AllowDuplicateRelationships>True</AllowDuplicateRelationships>
                <SourceECInstanceIdColumn>RootElementId</SourceECInstanceIdColumn>
                <TargetECInstanceIdColumn>DependentElementId</TargetECInstanceIdColumn>
            </LinkTableRelationshipMap>
        </ECCustomAttributes>
        <Source cardinality="(0,N)" polymorphic="True">
            <Class class="Element" />
        </Source>
        <Target cardinality="(0,N)" polymorphic="True">
            <Class class="Element" />
        </Target>
        <ECProperty propertyName="Status" typeName="int" description="Bits that indicate the status of the dependency. Satisfied=0, Failed=1, Deferred=128. Deferred and Failed bits can be OR'd together."/>
        <ECProperty propertyName="Priority" typeName="int" description="The priority of this dependency, relative to other EntityDrivesEntity instances. Note that EntityHasChildEntities dependencies always take priority over EntityDrivesEntity dependencies."/>
    </ECRelationshipClass>

    <ECClass typeName="Category" isDomainClass="True">
        <ECCustomAttributes>
            <ClassHasHandler xmlns="dgn.02.00" />
        </ECCustomAttributes>
        <BaseClass>DictionaryElement</BaseClass>
        <ECProperty propertyName="Descr" DisplayLabel="Description" typeName="string" />
        <ECProperty propertyName="Scope" typeName="int" />
        <ECProperty propertyName="Rank" typeName="int" />
    </ECClass>
    <ECClass typeName="SubCategory" isDomainClass="True">
        <ECCustomAttributes>
            <ClassHasHandler xmlns="dgn.02.00" />
        </ECCustomAttributes>
        <BaseClass>DictionaryElement</BaseClass>
        <ECProperty propertyName="Descr" displayLabel="Description" typeName="string"/>
        <ECProperty propertyName="Props" typeName="string"/>
    </ECClass>

    <ECClass typeName="TrueColor" isDomainClass="True" >
        <ECCustomAttributes>
            <ClassHasHandler xmlns="dgn.02.00" />
        </ECCustomAttributes>
        <BaseClass>DictionaryElement</BaseClass>
        <ECProperty propertyName="Data" displayLabel="" typeName="int" />
    </ECClass>

    <ECClass typeName="MaterialElement" isDomainClass="True">
        <ECCustomAttributes>
            <ClassHasHandler xmlns="dgn.02.00" />
        </ECCustomAttributes>
        <BaseClass>DictionaryElement</BaseClass>
        <ECProperty propertyName="Descr" displayLabel="Description" typeName="string" />
        <ECProperty propertyName="Data" displayLabel="" typeName="string" />
    </ECClass>

    <ECClass typeName="AnnotationTextStyle" isDomainClass="True">
        <ECCustomAttributes>
            <ClassHasHandler xmlns="dgn.02.00" />
        </ECCustomAttributes>
        <BaseClass>DictionaryElement</BaseClass>
        <ECProperty propertyName="Descr" displayLabel="Description" typeName="string" description="Description of the style" />
        <ECProperty propertyName="Data" displayLabel="Data" typeName="binary" description="Encoded style properties" />
    </ECClass>

    <ECClass typeName="AnnotationFrameStyle" isDomainClass="True">
        <ECCustomAttributes>
            <ClassHasHandler xmlns="dgn.02.00" />
        </ECCustomAttributes>
        <BaseClass>DictionaryElement</BaseClass>
        <ECProperty propertyName="Descr" displayLabel="Description" typeName="string" description="Description of the style" />
        <ECProperty propertyName="Data" displayLabel="Data" typeName="binary" description="Encoded style properties" />
    </ECClass>

    <ECClass typeName="AnnotationLeaderStyle" isDomainClass="True">
        <ECCustomAttributes>
            <ClassHasHandler xmlns="dgn.02.00" />
        </ECCustomAttributes>
        <BaseClass>DictionaryElement</BaseClass>
        <ECProperty propertyName="Descr" displayLabel="Description" typeName="string" description="Description of the style" />
        <ECProperty propertyName="Data" displayLabel="Data" typeName="binary" description="Encoded style properties" />
    </ECClass>

    <ECClass typeName="TextAnnotationSeed" isDomainClass="True">
        <ECCustomAttributes>
            <ClassHasHandler xmlns="dgn.02.00" />
        </ECCustomAttributes>
        <BaseClass>DictionaryElement</BaseClass>
        <ECProperty propertyName="Descr" displayLabel="Description" typeName="string" description="Description of the style" />
        <ECProperty propertyName="Data" displayLabel="Data" typeName="binary" description="Encoded style properties" />
    </ECClass>

    <ECClass typeName="LineStyle" isDomainClass="True">
        <ECCustomAttributes>
            <ClassHasHandler xmlns="dgn.02.00" />
        </ECCustomAttributes>
        <BaseClass>DictionaryElement</BaseClass>
        <ECProperty propertyName="Descr" displayLabel="Description" typeName="string" description="Description of the style" />
        <ECProperty propertyName="Data" displayLabel="Data" typeName="string" description="Encoded style properties" />
    </ECClass>

    <ECClass typeName="Texture" isDomainClass="True">
        <ECCustomAttributes>
            <ClassHasHandler xmlns="dgn.02.00" />
        </ECCustomAttributes>
        <BaseClass>DictionaryElement</BaseClass>
        <ECProperty propertyName="Descr" displayLabel="Description" typeName="string" />
        <ECProperty propertyName="Data" displayLabel="" typeName="binary" description="Encoded texture data">
            <ECCustomAttributes>
                <PropertyMap xmlns="ECDbMap.01.00">
                    <IsNullable>True</IsNullable><!-- actually False, but shared table... -->
                </PropertyMap>
            </ECCustomAttributes>
        </ECProperty>
        <ECProperty propertyName="Format" typeName="int" description="Format of the encoded texture data">
            <ECCustomAttributes>
                <PropertyMap xmlns="ECDbMap.01.00">
                    <IsNullable>True</IsNullable><!-- actually False, but shared table... -->
                </PropertyMap>
            </ECCustomAttributes>
        </ECProperty>
        <ECProperty propertyName="Width" typeName="int" displayLabel="Width">
            <ECCustomAttributes>
                <PropertyMap xmlns="ECDbMap.01.00">
                    <IsNullable>True</IsNullable><!-- actually False, but shared table... -->
                </PropertyMap>
            </ECCustomAttributes>
        </ECProperty>
        <ECProperty propertyName="Height" typeName="int" displayLabel="Height">
            <ECCustomAttributes>
                <PropertyMap xmlns="ECDbMap.01.00">
                    <IsNullable>True</IsNullable><!-- actually False, but shared table... -->
                </PropertyMap>
            </ECCustomAttributes>
        </ECProperty>
        <ECProperty propertyName="Flags" typeName="int">
            <ECCustomAttributes>
                <PropertyMap xmlns="ECDbMap.01.00">
                    <IsNullable>True</IsNullable><!-- actually False, but shared table... -->
                </PropertyMap>
            </ECCustomAttributes>
        </ECProperty>
    </ECClass>

    <ECClass typeName="LightDefinition" isDomainClass="True">
        <ECCustomAttributes>
            <ClassHasHandler xmlns="dgn.02.00" />
        </ECCustomAttributes>
        <BaseClass>DictionaryElement</BaseClass>
        <ECProperty propertyName="Descr" displayLabel="Description" typeName="string" />
        <ECProperty propertyName="Value" displayLabel="" typeName="string" />
    </ECClass>

    <ECClass typeName="ViewDefinition" isDomainClass="False" isCustomAttributeClass="False" isStruct="False">
        <!-- abstract -->
        <BaseClass>DictionaryElement</BaseClass>
        <ECProperty propertyName="Descr" displayLabel="Description" typeName="string" />
        <ECProperty propertyName="Source" displayLabel="Source" typeName="int" />
        <ECProperty propertyName="BaseModelId" displayLabel="Base Model" typeName="long">
            <!-- Foreign key relationship: BaseModelForView.ModelId -->
            <ECCustomAttributes>
                <PropertyMap xmlns="ECDbMap.01.00">
                    <IsNullable>True</IsNullable><!-- Want "False" but shared table prohibits that...must enforce in code... -->
                </PropertyMap>
            </ECCustomAttributes>
        </ECProperty>
    </ECClass>
    <ECRelationshipClass typeName="BaseModelForView" isDomainClass="True" strength="embedding" strengthDirection="forward"><!-- only "embedding" because ECDb requires that for ON DELETE CASCADE... -->
        <ECCustomAttributes>
            <ForeignKeyRelationshipMap xmlns="ECDbMap.01.00">
                <OnDeleteAction>Cascade</OnDeleteAction>
            </ForeignKeyRelationshipMap>
        </ECCustomAttributes>
        <Source cardinality="(1,1)" roleLabel="is base model for view" polymorphic="True">
            <Class class="Model" />
        </Source>
        <Target cardinality="(0,N)" roleLabel="is used by N views" polymorphic="True">
            <Class class="ViewDefinition">
                <Key>
                    <Property name="BaseModelId" />
                </Key>
            </Class>
        </Target>
    </ECRelationshipClass>

    <ECClass typeName="PhysicalViewDefinition" isDomainClass="True">
        <BaseClass>ViewDefinition</BaseClass>
        <ECCustomAttributes>
            <ClassHasHandler xmlns="dgn.02.00" />
        </ECCustomAttributes>
    </ECClass>
    <ECClass typeName="CameraViewDefinition" isDomainClass="True">
        <BaseClass>PhysicalViewDefinition</BaseClass>
        <ECCustomAttributes>
            <ClassHasHandler xmlns="dgn.02.00" />
        </ECCustomAttributes>
    </ECClass>
    <ECClass typeName="ViewDefinition2d" isDomainClass="False" isCustomAttributeClass="False" isStruct="False">
        <!-- abstract -->
        <BaseClass>ViewDefinition</BaseClass>
    </ECClass>
    <ECClass typeName="DrawingViewDefinition" isDomainClass="True">
        <BaseClass>ViewDefinition2d</BaseClass>
        <ECCustomAttributes>
            <ClassHasHandler xmlns="dgn.02.00" />
        </ECCustomAttributes>
    </ECClass>
    <ECClass typeName="SheetViewDefinition" isDomainClass="True">
        <BaseClass>ViewDefinition2d</BaseClass>
        <ECCustomAttributes>
            <ClassHasHandler xmlns="dgn.02.00" />
        </ECCustomAttributes>
    </ECClass>
    <ECClass typeName="RedlineViewDefinition" isDOmainClass="True">
        <BaseClass>SheetViewDefinition</BaseClass>
        <ECCustomAttributes>
            <ClassHasHandler xmlns="dgn.02.00" />
        </ECCustomAttributes>
    </ECClass>

    <ECClass typeName="Link" description="Base class for links from elements to other objects (e.g. URLs and embedded files).">
        <ECCustomAttributes>
            <ClassMap xmlns="ECDbMap.01.00">
                <ECInstanceIdColumn>Id</ECInstanceIdColumn>
            </ClassMap>
        </ECCustomAttributes>
        <ECProperty propertyName="Type" typeName="int" description="Type of style; see DGN_LINK_TYPE_*">
            <ECCustomAttributes>
                <PropertyMap xmlns="ECDbMap.01.00">
                    <IsNullable>False</IsNullable>
                </PropertyMap>
            </ECCustomAttributes>
        </ECProperty>
        <ECProperty propertyName="DisplayLabel" typeName="string" description="Display label for this node">
            <ECCustomAttributes>
                <PropertyMap xmlns="ECDbMap.01.00">
                    <IsNullable>False</IsNullable>
                </PropertyMap>
            </ECCustomAttributes>
        </ECProperty>
        <ECProperty propertyName="Data" typeName="binary" description="Encoded link properties"/>
    </ECClass>
    <ECRelationshipClass typeName="ElementHasLinks" description="Associates links to an entity.">
        <ECCustomAttributes>
            <ClassMap xmlns="ECDbMap.01.00">
                <ECInstanceIdColumn>Id</ECInstanceIdColumn>
            </ClassMap>
            <LinkTableRelationshipMap xmlns="ECDbMap.01.00">
                <SourceECInstanceIdColumn>ElementId</SourceECInstanceIdColumn>
                <TargetECInstanceIdColumn>LinkId</TargetECInstanceIdColumn>
            </LinkTableRelationshipMap>
        </ECCustomAttributes>
        <Source cardinality="(1,N)" roleLabel="has 0 to N links" polymorphic="True">
            <Class class="Element" />
        </Source>
        <Target cardinality="(0,N)" roleLabel="is on 1 or more elements" polymorphic="False">
            <Class class="Link" />
        </Target>
    </ECRelationshipClass>

    <!-- ////////////////////////////////////////////////////////////////////////////// -->
    <!-- // DgnDb "implementation detail" classes -->
    <!-- ////////////////////////////////////////////////////////////////////////////// -->

    <ECClass typeName="EGASpecifier" description="Specifies an EGA" isCustomAttributeClass="True">
        <ECProperty propertyName="Type" typeName="string" description="The kind of EGA implementation that must be executed. One of: JavaScript, ... TBD" />
        <ECProperty propertyName="Name" typeName="string" description="Identifies the script or parametric model within the Db that will be executed. For scripts, this should have the form program_name:function_name" />
        <ECProperty propertyName="Inputs" typeName="string" description="comma-separated list of input parameter names. These are bound by name to the item's properties." />
    </ECClass>
    -->

    <ECClass typeName="ElementRTree" isDomainClass="True" >
        <ECCustomAttributes>
            <ClassMap xmlns="ECDbMap.01.00">
                <MapStrategy>
                    <Strategy>ExistingTable</Strategy>
                </MapStrategy>
                <TableName>dgn_RTree3d</TableName>
                <ECInstanceIdColumn>ElementId</ECInstanceIdColumn>
            </ClassMap>
        </ECCustomAttributes>
        <ECProperty propertyName="MinX" typeName="double"/>
        <ECProperty propertyName="MaxX" typeName="double"/>
        <ECProperty propertyName="MinY" typeName="double"/>
        <ECProperty propertyName="MaxY" typeName="double"/>
        <ECProperty propertyName="MinZ" typeName="double"/>
        <ECProperty propertyName="MaxZ" typeName="double"/>
    </ECClass>

    <ECClass typeName="GeomPart" isDomainClass="True">
        <!-- WIP: need to create a partial index on Code -->
        <ECCustomAttributes>
            <ClassMap xmlns="ECDbMap.01.00">
                <ECInstanceIdColumn>Id</ECInstanceIdColumn>
            </ClassMap>
        </ECCustomAttributes>
        <ECProperty propertyName="Code" typeName="string">
            <!-- "Code" must be unique (or Null). Typically programmatically-generated -->
            <ECCustomAttributes>
                <PropertyMap xmlns="ECDbMap.01.00">
                    <!-- Null means an "anonymous" GeomPart that can only be looked up by Id -->
                    <IsNullable>True</IsNullable>
                </PropertyMap>
            </ECCustomAttributes>
        </ECProperty>
        <ECProperty propertyName="Geom" typeName="binary">
            <ECCustomAttributes>
                <PropertyMap xmlns="ECDbMap.01.00">
                    <IsNullable>False</IsNullable>
                </PropertyMap>
            </ECCustomAttributes>
        </ECProperty>
    </ECClass>
    <ECRelationshipClass typeName="ElementUsesGeomParts" isDomainClass="True" strength="referencing" strengthDirection="forward">
        <!-- Used to indicate that an Element uses a GeomPart.  This is useful for "garbage collecting" or finding Elements that would be affected by a change to a GeomPart. -->
        <ECCustomAttributes>
            <ClassMap xmlns="ECDbMap.01.00">
                <ECInstanceIdColumn>Id</ECInstanceIdColumn>
            </ClassMap>
            <LinkTableRelationshipMap xmlns="ECDbMap.01.00">
                <SourceECInstanceIdColumn>ElementId</SourceECInstanceIdColumn>
                <TargetECInstanceIdColumn>GeomPartId</TargetECInstanceIdColumn>
            </LinkTableRelationshipMap>
        </ECCustomAttributes>
        <Source cardinality="(0,N)" polymorphic="False">
            <Class class="Element" />
        </Source>
        <Target cardinality="(0,N)" polymorphic="False">
            <Class class="GeomPart" />
        </Target>
    </ECRelationshipClass>
    <!-- NEEDSWORK ECRelationships don't support abstract endpoints
    <ECRelationshipClass typeName="CategoryContainsGeometry" isDomainClass="True" strengthDirection="forward" strength="referencing">
        <ECCustomAttributes>
            <ForeignKeyRelationshipMap xmlns="ECDbMap.01.00">
                <OnDeleteAction>NoAction</OnDeleteAction>
                <CreateIndex>True</CreateIndex>
            </ForeignKeyRelationshipMap>
        </ECCustomAttributes>
        <Source cardinality="(1,1)" roleLabel="contains geometry" polymorphic="False">
            <Class class="Category" />
        </Source>
        <Target cardinality="(0,N)" roleLabel="is in category" polymorphic="False">
            <Class class="GeometrySource">
                <Key>
                    <Property name="CategoryId" />
                </Key>
            </Class>
        </Target>
    </ECRelationshipClass>
    -->
    
    <!-- ////////////////////////////////////////////////////////////////////////////// -->
    <!-- // Deprecated classes -->
    <!-- ////////////////////////////////////////////////////////////////////////////// -->

    <ECRelationshipClass typeName="ModelDrivesModel" isDomainClass="True" strength="referencing" strengthDirection="forward">
        <!-- Deprecated? Replaced by ModelDescribesItem relationship? -->
        <!-- Relationship that indicates that a Model drives (controls the lifecyle or structure of) a dependent Model -->
        <ECCustomAttributes>
            <ClassMap xmlns="ECDbMap.01.00">
                <MapStrategy>
                    <Strategy>SharedTable</Strategy>
                    <AppliesToSubclasses>True</AppliesToSubclasses>
                </MapStrategy>
            </ClassMap>
            <LinkTableRelationshipMap xmlns="ECDbMap.01.00">
                <SourceECInstanceIdColumn>RootModelId</SourceECInstanceIdColumn>
                <TargetECInstanceIdColumn>DependentModelId</TargetECInstanceIdColumn>
            </LinkTableRelationshipMap>
        </ECCustomAttributes>
        <Source cardinality="(0,N)" polymorphic="True">
            <Class class="Model" />
        </Source>
        <Target cardinality="(0,N)" polymorphic="True">
            <Class class="Model" />
        </Target>
    </ECRelationshipClass>

</ECSchema>
