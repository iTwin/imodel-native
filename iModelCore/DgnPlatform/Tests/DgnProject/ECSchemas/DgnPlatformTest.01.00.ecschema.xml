<?xml version="1.0" encoding="utf-8"?>
<ECSchema schemaName="DgnPlatformTest" nameSpacePrefix="dptest" version="1.0" xmlns="http://www.bentley.com/schemas/Bentley.ECXML.2.0">

    <ECSchemaReference name="Bentley_Standard_CustomAttributes" version="01.10" prefix="bsca" />
    <ECSchemaReference name="EditorCustomAttributes" version="01.00" prefix="beca" />
    <ECSchemaReference name="ECDbMap" version="01.00" prefix="ecdbmap" />
    <ECSchemaReference name="dgn" version="02.00" prefix="dgn" />

    <ECClass typeName="TestElement" isDomainClass="True">
        <ECCustomAttributes>
            <ClassHasHandler xmlns="dgn.02.00" />
        </ECCustomAttributes>
        <BaseClass>dgn:PhysicalElement</BaseClass>
        <ECProperty propertyName="TestElementProperty" typeName="string" />
    </ECClass>

    <ECClass typeName="TestElement2d" isDomainClass="True">
        <ECCustomAttributes>
            <ClassHasHandler xmlns="dgn.02.00" />
        </ECCustomAttributes>
        <BaseClass>dgn:DrawingElement</BaseClass>
        <ECProperty propertyName="TestElementProperty" typeName="string" />
    </ECClass>

    <ECClass typeName="TestUniqueAspect" isDomainClass="True">
        <ECCustomAttributes>
            <ClassHasHandler xmlns="dgn.02.00" />
            <ClassMap xmlns="ECDbMap.01.00">
                <ECInstanceIdColumn>ElementId</ECInstanceIdColumn>
            </ClassMap>
        </ECCustomAttributes>
        <BaseClass>dgn:ElementUniqueAspect</BaseClass>
        <ECProperty propertyName="TestUniqueAspectProperty" typeName="string" />
        <ECProperty propertyName="Length" typeName="double" />
    </ECClass>
    <ECRelationshipClass typeName="ElementOwnsTestUniqueAspect" isDomainClass="True" strength="embedding" strengthDirection="forward">
        <ECCustomAttributes>
            <ForeignKeyRelationshipMap xmlns="ECDbMap.01.00">
                <OnDeleteAction>Cascade</OnDeleteAction>
            </ForeignKeyRelationshipMap>
        </ECCustomAttributes>
        <Source cardinality="(1,1)" polymorphic="True">
            <Class class="dgn:Element" />
        </Source>
        <Target cardinality="(0,1)" polymorphic="False">
            <Class class="TestUniqueAspect">
                <Key>
                    <Property name="ECInstanceId"/>
                </Key>
            </Class>
        </Target>
    </ECRelationshipClass>

    <ECClass typeName="TestMultiAspect" isDomainClass="True">
        <ECCustomAttributes>
            <ClassHasHandler xmlns="dgn.02.00" />
        </ECCustomAttributes>
        <BaseClass>dgn:ElementMultiAspect</BaseClass>
        <ECProperty propertyName="TestMultiAspectProperty" typeName="string" />
    </ECClass>

    <ECRelationshipClass typeName="TestElementDrivesElement" isDomainClass="True" strength="referencing" strengthDirection="forward" >
        <ECCustomAttributes>
          <ClassHasHandler xmlns="dgn.02.00" />
          <LinkTableRelationshipMap xmlns="ECDbMap.01.00">
                <SourceECInstanceIdColumn>RootElementId</SourceECInstanceIdColumn>
                <SourceECClassIdColumn>RootElementClassId</SourceECClassIdColumn>
                <TargetECInstanceIdColumn>DependentElementId</TargetECInstanceIdColumn>
                <TargetECClassIdColumn>DependentElementClassId</TargetECClassIdColumn>
              <AllowDuplicateRelationships>True</AllowDuplicateRelationships>
            </LinkTableRelationshipMap>
        </ECCustomAttributes>
        <BaseClass>dgn:ElementDrivesElement</BaseClass>
        <Source cardinality="(0,1)" roleLabel="Element with datum plane" polymorphic="True">
            <Class class="dgn:Element" />
        </Source>
        <Target cardinality="(0,1)" roleLabel="Element to move" polymorphic="True">
            <Class class="dgn:Element" />
        </Target>
        <ECProperty propertyName="Property1" typeName="string" />
    </ECRelationshipClass>

    <ECClass typeName="TestGroup" isDomainClass="True">
        <!-- Used to test the IElementGroup interface -->
        <ECCustomAttributes>
            <ClassHasHandler xmlns="dgn.02.00" />
        </ECCustomAttributes>
        <BaseClass>dgn:PhysicalElement</BaseClass>
    </ECClass>

    <ECClass typeName="TestRequirement" isDomainClass="True">
        <!-- Used to test the dgn:SystemElement abstract base class -->
        <ECCustomAttributes>
            <ClassHasHandler xmlns="dgn.02.00" />
        </ECCustomAttributes>
        <BaseClass>dgn:SystemElement</BaseClass>
    </ECClass>

    <ECClass typeName="Robot" isDomainClass="true">
        <ECCustomAttributes>
            <ClassHasHandler xmlns="dgn.02.00" />
        </ECCustomAttributes>
        <BaseClass>dgn:PhysicalElement</BaseClass>
        <ECProperty propertyName="Name" typeName="string" />
    </ECClass>

    <ECClass typeName="Obstacle" isDomainClass="true">
        <ECCustomAttributes>
            <ClassHasHandler xmlns="dgn.02.00" />
        </ECCustomAttributes>
        <BaseClass>dgn:PhysicalElement</BaseClass>
        <ECProperty propertyName="CanMove" typeName="boolean" />
        <ECProperty propertyName="SomeProperty" typeName="string" />
    </ECClass>

    <ECClass typeName="RestrictedElement1" isDomainClass="true">
        <ECCustomAttributes>
            <ClassHasHandler xmlns="dgn.02.00">
                <Restrictions>
                    <string>Delete</string>
                    <string>Insert</string>
                    <string>SetCode</string>
                    <string>DeleteChild</string>
                    <string>Move</string>
                    <string>SetGeometry</string>
                </Restrictions>
            </ClassHasHandler>
        </ECCustomAttributes>
        <BaseClass>dgn:PhysicalElement</BaseClass>
    </ECClass>

    <ECClass typeName="RestrictedElement2" isDomainClass="true">
        <ECCustomAttributes>
            <ClassHasHandler xmlns="dgn.02.00">
                <Restrictions>
                    <string>Clone</string>
                    <string>SetParent</string>
                    <string>InsertChild</string>
                    <string>UpdateChild</string>
                    <string>SetCategory</string>
                </Restrictions>
            </ClassHasHandler>
        </ECCustomAttributes>
        <BaseClass>dgn:PhysicalElement</BaseClass>
    </ECClass>
</ECSchema>

