#----------------------------------------------------------------------
#
#     $Source: Tests/DgnProject/Compatibility/CompatibilityRunner/PullCompatibilityNugets.mke $
#
#  $Copyright: (c) 2018 Bentley Systems, Incorporated. All rights reserved. $
#
#----------------------------------------------------------------------

#----------------------------------------------------------
# Set up all the standard stuff.
#----------------------------------------------------------
%include  mdl.mki

#----------------------------------------------------------
# Make a subdir for the nuget packages, pull them from server
# link them to the product directory so they are set up to run
# against the same data
#----------------------------------------------------------

NUGET_DIR = $(SrcRoot)/nuget/iModelCompatibility/
IMS_DIR = $(OutputRootDir)iModelSchemaEvolution
ASSETS_DIR = $(IMS_DIR)/Assets
IMS_NUGETS_DIR = $(IMS_DIR)/Nugets
always:
    ~mkdir $(NUGET_DIR)
    ~mkdir $(IMS_DIR)
    ~mkdir $(ASSETS_DIR)
    $(SrcRoot)bsicommon/build/CopyWithSymlinks.py $(BuildContext)Delivery/Gtest/DgnCompatibility/Assets/ $(ASSETS_DIR)
    python PullCompatibilityNugets.py $(NUGET_DIR)
    $(SrcRoot)bsicommon/build/CopyWithSymlinks.py $(NUGET_DIR) $(IMS_NUGETS_DIR)
    python SymLinkAssetDir.py $(SrcRoot)bsicommon/build/CopyWithSymlinks.py $(ASSETS_DIR) $(IMS_NUGETS_DIR)
