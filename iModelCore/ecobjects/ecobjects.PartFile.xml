<?xml version="1.0" encoding="utf-8"?>

<BuildContext xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="../bsicommon/build/PartFile.xsd" >

<!-- ///////////////////////////////////////////////////////////////////////////////////// -->
<!-- ///////////////////// Runtime Parts ///////////////////////////////////////////////// -->
<!-- / This section contains parts that make the ECF Runtime ///////////////////////////// -->
<!-- ///////////////////////////////////////////////////////////////////////////////////// -->

    <Part Name="ECObjectsNative" BentleyBuildMakeFile="src/ecobjects.mke" ApiNumber="4">
        <SubPart PartName="BoostHeaders"    PartFile="${SrcBsiCommon}CvsPartfiles/bsibin"           Repository="bsibin-boostheaders" />
        <SubPart PartName="HeaderFiles" />
        <SubPart PartName="BentleyDll"      PartFile="Bentley"      Repository="Bentley" />
        <SubPart PartName="Logging8.11"     PartFile="${SrcBsiCommon}CvsPartfiles/bsibin"           Repository="bsibin-loggingsdk" />
        <SubPart PartName="GeomDlls"        PartFile="geomlibs"     Repository="GeomLibs" />
        <SubPart PartName="BeXmlDll"        PartFile="BeLibxml2"    Repository="libsrc-libxml2" />
        <SubPart PartName="StandardSchemas" PartFile="ECStandards"  Repository="ECStandards"/>
        <Bindings>
            <Libs ProductDirectoryName="ECObjectsLibs" Required="false">Delivery/$(libprefix)ECObjects$(libext)</Libs>
            <Files ProductDirectoryName="ECObjectsNativeAssemblies">Delivery/$(shlibprefix)ECObjects$(ApiNumber)$(shlibext)</Files>
        </Bindings>
    </Part>

    <Part Name="ECObjectsNativeStatic" BMakeOptions="+d__CREATE_STATIC_LIBRARIES__" BentleyBuildMakeFile="src/ecobjects.mke" ApiNumber="4">
        <SubPart PartName="BoostHeaders"        PartFile="${SrcBsiCommon}CvsPartfiles/bsibin"   Repository="bsibin-boostheaders" />
        <SubPart PartName="HeaderFiles" />
        <SubPart PartName="BentleyStaticLib"    PartFile="Bentley"                              Repository="Bentley" />
        <SubPart PartName="Logging8.11Static"   PartFile="${SrcBsiCommon}CvsPartfiles/bsibin"   Repository="bsibin-loggingsdk" />
        <SubPart PartName="GeomStatic"          PartFile="geomlibs"                             Repository="GeomLibs" />
        <SubPart PartName="BeXmlStaticLib"      PartFile="BeLibxml2"                            Repository="libsrc-libxml2" />
        <SubPart PartName="StandardSchemas"     PartFile="ECStandards"                          Repository="ECStandards"/>
        <Bindings>
            <Libs>Delivery/$(stlibprefix)ECObjectsStatic$(stlibext)</Libs>
            <Libs>Delivery/$(stlibprefix)ECObjectsStatic$(stlibdebugext)</Libs>
        </Bindings>
    </Part>

    <Part Name="PublishedApi" BentleyBuildMakeFile="PublicAPI/PublishApi.mke">
        <SubPart PartName="HeaderFiles" />
        <Bindings>
            <Directory SubPartDirectory="PublishedAPI" SourceName="Delivery/PublishedApi" ProductDirectoryName="PublishedAPI" Required="false"/>
        </Bindings>
    </Part>

    <Part Name="PublishedApi_Doc" BentleyBuildMakeFile="PublicAPI/BuildPublishedDoc.mke">
        <RequiredRepository>bsitools-doxygen</RequiredRepository>
        <SubPart PartName="PublishedApi" />
        <Bindings>
            <Files ProductDirectoryName="PublishedApi_Doc" IfNotPresent="Warn" Required="false">Delivery/ECObjectsAPI.chm</Files>
        </Bindings>
    </Part>   

    <Part Name="HeaderFiles" BentleyBuildMakeFile="ecobjects.prewire.mke">
        <Bindings>
            <PublicAPI Domain="ECObjects" />
        </Bindings>
    </Part>

    <Part Name="ECObjectsTestsSeedData" BentleyBuildMakeFile="test/SeedData.prewire.mke" ExcludePlatforms="Android,Linux,iOSX86,iOSARM">
        <Bindings>
            <Files SubPartDirectory="SeedData" ProductDirectoryName="ECObjectsTestSeedData">Delivery/SeedData/*</Files>
        </Bindings>
    </Part>

    <Part Name="ECObjectsTestLoggingConfig" BentleyBuildMakeFile="test/LoggingConfig.prewire.mke" ExcludePlatforms="Android,Linux,iOSX86,iOSARM">
        <Bindings>
            <Files ProductDirectoryName="ECObjectsTestExe">Delivery/logging.config.xml</Files>
        </Bindings>
    </Part>

    <Part Name="ECObjectsTestBackDoor" BentleyBuildMakeFile="test/BackDoor/BackDoor.mke" ExcludePlatforms="Android,Linux,iOSX86,iOSARM">
        <Bindings>
            <Libs>Delivery/$(libprefix)ECObjectsTestBackDoor$(libext)</Libs>
        </Bindings>
    </Part>

    <Part Name="ECObjectsTestsDependencies">
        <SubPart PartName="google_gtest"         PartFile="gtest"                   Repository="util-gtest" />
        <SubPart PartName="StandardSchemas"      PartFile="ecstandards"             Repository="ecstandards"/>
        <SubPart PartName="Logging8.11"  PartFile="${SrcBsiCommon}CvsPartfiles/bsibin"               Repository="bsibin-loggingsdk" />
        <SubPart PartName="ECObjectsNative" />
        <SubPart PartName="ECObjectsTestsSeedData"/>
        <SubPart PartName="ECObjectsTestLoggingConfig"/>
        <SubPart PartName="ECObjectsTestBackDoor"/>
    </Part>

    <Part Name="ECObjectsPublishedTests" BentleyBuildMakeFile="test/PublishedTests.mke" ExcludePlatforms="Android,Linux,iOSX86,iOSARM">
        <SubPart PartName="ECObjectsTestsDependencies"/>
        <SubPart PartName="PublishedApi"/>
        <Bindings>
            <Files ProductDirectoryName="ECObjectsTestExe">Delivery/ECObjectsTest_Published.exe</Files>
        </Bindings>
    </Part>

    <Part Name="ECObjectsNonPublishedTests" BentleyBuildMakeFile="test/NonPublishedTests.mke" ExcludePlatforms="Android,Linux,iOSX86,iOSARM">
        <SubPart PartName="ECObjectsTestsDependencies"/>
        <Bindings>
            <Files ProductDirectoryName="ECObjectsTestExe">Delivery/ECObjectsTest_NonPublished.exe</Files>
        </Bindings>
    </Part>

    <Part Name="ECObjectsScenarioTests" BentleyBuildMakeFile="test\scenarioTests.mke" ExcludePlatforms="Android,Linux,iOS">
        <SubPart PartName="ECObjectsTestsDependencies"/>
        <Bindings>
            <Files ProductDirectoryName="ECObjectsTestExe">Delivery\ECObjectsTest_scenario.exe</Files>
        </Bindings>
    </Part>


    <Part Name="ECObjectsPerformanceTests" BentleyBuildMakeFile="test\PerformanceTests.mke" ExcludePlatforms="Android,Linux,iOS">
      <SubPart PartName="ECObjectsTestsDependencies"/>
      <SubPart PartName="PublishedApi"/>
      <Bindings>
        <Files ProductDirectoryName="ECObjectsTestExe">Delivery\ECObjectsTest_Performance.exe</Files>
      </Bindings>
    </Part>

    <Part Name="Tests">
        <SubPart PartName="ECObjectsPublishedTests" />
        <SubPart PartName="ECObjectsNonPublishedTests" />
        <SubPart PartName="ECObjectsPerformanceTests" />
        <SubPart PartName="ECObjectsScenarioTests" />
    </Part>

    <Part Name="RunECObjectsTests" BentleyBuildMakeFile="test/ECObjectsNativeTest.run.mke" ExcludePlatforms="Android,Linux,iOSX86,iOSARM">

    </Part>

    <Part Name="RunECObjectsPerformanceTests" BentleyBuildMakeFile="test\ECObjectsPerformanceTest.run.mke">

    </Part>

<!-- ///////////////////////////////////////////////////////////////////////////////////// -->
<!-- ////////////////////////////////// Products ///////////////////////////////////////// -->
<!-- ///////////////////////////////////////////////////////////////////////////////////// -->

    <ProductDirectoryList ListName="ECObjects">
        <ProductDirectory Name="PublicAPI"                          Deliver="false"/>
        <ProductDirectory Name="VendorAPI"                          Deliver="false" />
        <ProductDirectory Name="LoggingWorkspaceData"               Deliver="false"/>
        <ProductDirectory Name="LoggingManagedAssemblies"           Deliver="false"/>
        <ProductDirectory Name="LoggingOptionalManagedAssemblies"   Deliver="false"/>
        <ProductDirectory Name="mergemodules"                       Deliver="false"/>
        <ProductDirectory Name="libs"                               Deliver="false"/>

        <ProductDirectory Name="loggingnativeassemblies"            Path="Runtime"/>
        <ProductDirectory Name="LoggingOptionalNativeAssemblies"    Path="Runtime"/>
        <ProductDirectory Name="BentleyNativeAssemblies"            Path="Runtime"/>
        <ProductDirectory Name="GeomNativeAssemblies"               Path="Runtime"/>
        <ProductDirectory Name="ecobjectsnativeassemblies"          Path="Runtime"/>
        <ProductDirectory Name="PublishedApi"                       Path="Include"/>        
        <ProductDirectory Name="PublishedApi_Doc"                   Path="Docs"/>
        <ProductDirectory Name="ecschemas"                          Path="Runtime"/>
    </ProductDirectoryList>

    <Product Name="ECObjects">
        <SubPart PartName="ECObjectsNative"/>
        <SubPart PartName="PublishedApi_Doc" />
        <Directories DirectoryListName="ECObjects"/>
    </Product>

    <ProductDirectoryList ListName="ECObjectsTest">
        <ProductDirectory Name="VendorAPI"                          Deliver="false" />
        <ProductDirectory Name="PublicAPI"                          Deliver="false"/>
        <ProductDirectory Name="LoggingWorkspaceData"               Deliver="false"/>
        <ProductDirectory Name="LoggingManagedAssemblies"           Deliver="false"/>
        <ProductDirectory Name="LoggingOptionalManagedAssemblies"   Deliver="false"/>
        <ProductDirectory Name="mergemodules"                       Deliver="false"/>
        <ProductDirectory Name="libs"                               Deliver="false"/>

        <ProductDirectory Name="ECObjectsTestSeedData"              Path="SeedData"/>
        <ProductDirectory Name="ECObjectsTestLoggingConfig"         Path=""/>

        <ProductDirectory Name="geomnativeassemblies"               Path=""/>
        <ProductDirectory Name="loggingnativeassemblies"            Path=""/>
        <ProductDirectory Name="LoggingOptionalNativeAssemblies"    Path="" />
        <ProductDirectory Name="BentleyNativeAssemblies"            Path=""/>
        <ProductDirectory Name="ECObjectsNativeAssemblies"          Path=""/>
        <ProductDirectory Name="ECObjectsTestExe"                   Path=""/>
        <ProductDirectory Name="ecschemas"                          Path=""/>
    </ProductDirectoryList>

    <Product Name="ECObjectsTests">
        <SubPart PartName="Tests"/>
        <Directories DirectoryListName="ECObjectsTest"/>
    </Product>

    <ProductDirectoryList ListName="ECObjectsTested">
    </ProductDirectoryList>
    <Product Name="ECObjectsTested" PrgOutputDir="ECObjects">
        <SubProduct ProductName="ECObjects" />
        <SubProduct ProductName="ECObjectsTests" />
        <SubPart PartName="RunECObjectsTests" />

        <Directories DirectoryListName="ECObjectsTested"/>
    </Product>

</BuildContext>
