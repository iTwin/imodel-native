<?xml version="1.0" encoding="utf-8"?>

<BuildContext xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="../bsicommon/build/PartFile.xsd">

    <!-- Bind my own PublicAPI into BuildContext/PublicAPI. Note that this part does not cause any sub-part PublicAPIs to be bound. Also deliver my license notice. -->
    <Part Name="PublicApi" BentleyBuildMakeFile="ImagePP.prewire.mke">
        <Bindings>
            <PublicAPI Domain="ImagePP" />
        </Bindings>
    </Part>

    <!-- ////////////////////////////// IPP external libs  ////////////////////////////////////// -->
    <Part Name="Base64Lib"  BentleyBuildMakeFile="ext/Base64/Base64.mke"> </Part>
    
    <Part Name="GdalLib"  BentleyBuildMakeFile="ext/gdal/gdal.mke">
        <SubPart PartName="png"             PartFile="png"              Repository="libsrc-png"/>
        <SubPart PartName="Zlib" PartFile="Zlib" Repository="Libsrc-Compress" />
        <SubPart PartName="BeLibJpegTurbo"  PartFile="BeLibJpegTurbo"   Repository="libsrc-libjpegturbo"/>
        <SubPart PartName="ErdasEcwJpeg2000"        PartFile="${SrcRoot}bsicommon/CvsPartfiles/ErdasEcwJpeg2000"     Repository="Bin-ErdasEcwJpeg2000" />
        <Bindings>
            <VendorAPI Domain="ImagePP-GdalLib" />
            <Libs>Delivery/$(stlibprefix)IppGdalLib$(stlibext)</Libs>
            <Libs>Delivery/$(stlibprefix)IppGdalLib$(stlibdebugext)</Libs>
            <Files ProductDirectoryName="VendorNotices" Required="true">Delivery/gdal-notice.txt</Files>
        </Bindings>

    </Part>
    <!-- The following parts allow to share gdal with Vortex using older compilers -->
    <Part Name="GdalLibVC11"  BentleyBuildMakeFile="ext/gdal/gdal.mke" BMakeOptions="+dBUILD_USING_VS2012=1" ExcludePlatforms="Android*">
        <SubPart PartName="ZLib" />
        <SubPart PartName="JpegLib" />
        <SubPart PartName="PngLib" />
        <SubPart PartName="ErdasEcwJpeg2000"        PartFile="${SrcRoot}bsicommon/CvsPartfiles/ErdasEcwJpeg2000"     Repository="Bin-ErdasEcwJpeg2000" />
        <Bindings>
            <VendorAPI Domain="ImagePP-GdalLib" />
            <Libs>Delivery/$(stlibprefix)IppGdalLibVC11$(stlibext)</Libs>
            <Libs>Delivery/$(stlibprefix)IppGdalLibVC11$(stlibdebugext)</Libs>
        </Bindings>
    </Part>
    <Part Name="GdalLibVC8"  BentleyBuildMakeFile="ext/gdal/gdal.mke" BMakeOptions="+dBUILD_USING_VS2005=1" ExcludePlatforms="Android*">
        <SubPart PartName="ZLib" />
        <SubPart PartName="JpegLib" />
        <SubPart PartName="PngLib" />
        <SubPart PartName="ErdasEcwJpeg2000"        PartFile="${SrcRoot}bsicommon/CvsPartfiles/ErdasEcwJpeg2000"     Repository="Bin-ErdasEcwJpeg2000" />
        <Bindings>
            <VendorAPI Domain="ImagePP-GdalLib" />
            <Libs>Delivery/$(stlibprefix)IppGdalLibVC8$(stlibext)</Libs>
            <Libs>Delivery/$(stlibprefix)IppGdalLibVC8$(stlibdebugext)</Libs>
        </Bindings>
    </Part>

    <Part Name="GdalData" BentleyBuildMakeFile="ext/gdal/GdalData.mke">
        <Bindings>
            <Directory  ProductDirectoryName="GdalData"  SourceName="Delivery\GdalData"    />
        </Bindings>
    </Part>
    <!-- Why so many jpeg libs?
        - JpegLib is the standard 8 bits library. We will use this one if we cannot use JpegLib-turbo.
        - jpeglib12BitsLib is built with the same source than JpegLib but with different function name decoration. Because 8 bits and 12 bits structures are different
          we cannot mix 8 bits and 12 bits jpeg structures in the same cpp files.
        - JpegLib-turbo is an optimized (x86/x64) version of JpegLib(8 bits only) and is designed to be compatible with Jpeglib. That mean we could build with jpeglib
          headers but substitute jpeglib.lib with jpeglibTurbo.lib at link time. The only requirements is that both version use the same internal jpeg version. 
          Basically we cannot update jpeglib if we do not have a jpeglibTurbo of the same version.
    -->
    <!--Part Name="JpegLib" BentleyBuildMakeFile="ext/jpeg/jpeg.mke">
        <Bindings>
            <VendorAPI Domain="ImagePP-jpeglib" />
            <Libs>Delivery/$(stlibprefix)IppJpegLib$(stlibext)</Libs>
            <Files ProductDirectoryName="VendorNotices" Required="true">Delivery/jpeg-notice.txt</Files>
        </Bindings>
    </Part-->

    <Part Name="Jpeg12BitsLib" BentleyBuildMakeFile="ext/jpeg/jpeg.mke" BMakeOptions="+dJPEGLIB_SUPPORT_12BITS"> </Part>
    
    <Part Name="MatrixFromTiePtsLib" BentleyBuildMakeFile="ext/MatrixFromTiePts/MatrixFromTiePts.mke"> 
        <SubPart PartName="PublicApi" />
        <SubPart PartName="BentleyDll"                      PartFile="Bentley"              Repository="Bentley" />
    </Part>
   
    <!-- //////////////////////////////  Imagepp Part ////////////////////////////////////// -->
    <!-- NOTE: Graphite uses "G" as an ApiNumber (library suffix) to disambiguate from Vancouver libraries -->
    <Part Name="ImagePPDll" BentleyBuildMakeFile="All/ImagePP.mke" ApiNumber="G">
        <SubPart PartName="PublicApi" />
        <SubPart PartName="ImagePPThirdPartsDll" />
        <SubPart PartName="BeXmlDll"                        PartFile="BeLibxml2"            Repository="libsrc-libxml2" />
        <SubPart PartName="BentleyDll"                      PartFile="Bentley"              Repository="Bentley" />
        <SubPart PartName="GeoCoordData"                    PartFile="csmap"                Repository="libsrc-csmap" />
        <SubPart PartName="GeoCoord"                        PartFile="GeoCoord"             Repository="GeoCoord" />
        <SubPart PartName="BeSQLite"                        PartFile="BeSQLite"             Repository="BeSQLite" />
        <SubPart PartName="BeLibJpegTurbo"                  PartFile="BeLibJpegTurbo"       Repository="libsrc-libjpegturbo"/>
        <SubPart PartName="Zlib"                            PartFile="Zlib"                 Repository="Libsrc-Compress" />
        <SubPart PartName="png"                             PartFile="png"                  Repository="libsrc-png"/>
        <SubPart PartName="Jpeg12BitsLib" />
        <SubPart PartName="GdalLib" />
        <SubPart PartName="GdalData" />
        <SubPart PartName="MatrixFromTiePtsLib" />
        <Bindings>
            <Libs>Delivery/$(shlibprefix)Imagepp$(libext)</Libs>
            <Assemblies ProductDirectoryName="ImagePPAssemblies">Delivery/$(shlibprefix)Imagepp$(ApiNumber)$(shlibext)
                <!--TransKit SourceDirectory="Delivery/ImagePP/Transkit" /-->
            </Assemblies>
            <Files ProductDirectoryName="xliffs" Required="false" SubPartDirectory="xliffs">
                Delivery/xliffs/ImagePPMessages_en.xliff
                Delivery/xliffs/ImagePPExceptionMessages_en.xliff
            </Files>
        </Bindings>
    </Part>
    
    <Part Name="ImagePPThirdPartsDll" OnlyPlatforms="x86,x64">
        <SubPart PartName="MrSid"                   PartFile="${SrcRoot}bsicommon/CvsPartfiles/mrsid"        Repository="Bin-MrSid" />
        <SubPart PartName="ErdasEcwJpeg2000"        PartFile="${SrcRoot}bsicommon/CvsPartfiles/ErdasEcwJpeg2000"     Repository="Bin-ErdasEcwJpeg2000" />
        <!--SubPart PartName="OracleSDK12.1"           PartFile="${SrcRoot}bsicommon/CvsPartfiles/oracle"       Repository="bin-oracle" />
        <SubPart PartName="PdfLibInitializer"       PartFile="PdfLibInitializer"                        Repository="PdfLibInterface"/>
        <SubPart PartName="Adobe11.0"               PartFile="${SrcRoot}bsicommon/CvsPartfiles/adobe"        Repository="bin-adobe11.0"/-->
    </Part>

   
    <!-- NOTE: Graphite uses "G" as an ApiNumber (library suffix) to disambiguate from Vancouver libraries -->
    <Part Name="IppImagingDll" BentleyBuildMakeFile="IppImaging/IppImaging.mke" ApiNumber="G" OnlyPlatforms="x86,x64">
        <SubPart PartName="ImagePPDll" />       
        <Bindings>
            <Libs>Delivery/$(shlibprefix)IppImaging$(libext)</Libs>
            <Assemblies ProductDirectoryName="ImagePPAssemblies">Delivery/$(shlibprefix)IppImaging$(ApiNumber)$(shlibext)</Assemblies>
        </Bindings>
    </Part>

    <!-- All ImagePP dlls -->
    <Part Name="ImagePP" OnlyPlatforms="x86,x64">
        <SubPart PartName="ImagePPDll" />
        <SubPart PartName="IppImagingDll" />
    </Part>

    <Part Name="ImagePP-Android">
        <SubPart PartName="ImagePPDll" LibType="Static"/>
        <SubPart PartName="IppImagingDll" LibType="Static"/>-->
    </Part>    
    
    <Part Name="ImagePP-Tested" PrgOutputDir="ImagePP" OnlyPlatforms="x86,x64">
        <SubPart PartName="ImagePP"/>
        <SubPart PartName="ImagePPUnitTests"    PartFile="ImagePPTest"  Repository="Imagepp"/>
        <SubPart PartName="BeGTestCommon"       PartFile="BeGTest"      Repository="BeGTest" />        
    </Part>

    <Part Name="ImagePP-Dev" OnlyPlatforms="x86,x64">
        <SubPart PartName= "ImagePP-Tested" />
        <SubProduct ProductName="ImageppApps"           PartFile="ImageppApps"          Repository="ImageppApps" />
    </Part>

    <!-- Use this part to validate that everything that use(and we maintain) IPP build
       PULL>  bb -r imagepp -f imagepp -p AllImagePPDependant pull 
       BUILD> bb -r imagepp -f imagepp -p AllImagePPDependant build /-->
    <Part Name="AllImagePPDependant">
        <SubPart    PartName="ImagePP-Tested" />
        <SubProduct ProductName="ImageppApps"           PartFile="ImageppApps"          Repository="ImageppApps" />
        <!--SubProduct ProductName="HugeDataTest"          PartFile="HugeDataTest"         Repository="HugeDataTest" /-->
        <!--SubProduct ProductName="HugeDataWinShellExt"   PartFile="HugeDataWinShellExt"  Repository="HugeDataWinShellExt" /-->
        <!--SubProduct ProductName="PlatformProducts"      PartFile="PlatformProducts"     Repository="MstnPlatform" /-->
    </Part>
    
</BuildContext>
